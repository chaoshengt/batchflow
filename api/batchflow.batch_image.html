

<!doctype html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ImagesBatch &#8212; BatchFlow 0.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Pipeline" href="batchflow.pipeline.html" />
    <link rel="prev" title="Batch" href="batchflow.batch.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="batchflow.pipeline.html" title="Pipeline"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="batchflow.batch.html" title="Batch"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">BatchFlow 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="batchflow.html" >API</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="batchflow.core.html" accesskey="U">batchflow</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="batchflow.batch.html"
                        title="previous chapter">Batch</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="batchflow.pipeline.html"
                        title="next chapter">Pipeline</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/batchflow.batch_image.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="imagesbatch">
<h1>ImagesBatch<a class="headerlink" href="#imagesbatch" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<dl class="class">
<dt id="batchflow.ImagesBatch">
<em class="property">class </em><code class="sig-name descname">ImagesBatch</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">preloaded=None</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/batch_image.html#ImagesBatch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.ImagesBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">batchflow.batch_image.BaseImagesBatch</span></code></p>
<p>Batch class for 2D images.</p>
<p>Images are stored as numpy arrays of PIL.Image.</p>
<dl>
<dt>PIL.Image has the following system of coordinates:</dt><dd><blockquote>
<div><p>X</p>
</div></blockquote>
<p>0 ————– &gt;
|
|
|  images’s pixels
|
|</p>
</dd>
</dl>
<p>Y v</p>
<p>Pixel’s position is defined as (x, y)</p>
<dl class="method">
<dt id="batchflow.ImagesBatch.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">term=1.0</em>, <em class="sig-param">clip=False</em>, <em class="sig-param">preserve_type=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add term to each pixel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>term</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>sequence</em>) – </p></li>
<li><p><strong>clip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to force image’s pixels to be in [0, 255] or [0, 1.]</p></li>
<li><p><strong>preserve_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to preserve <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of transformed images.
If <code class="docutils literal notranslate"><span class="pre">False</span></code> is given then the resulting type will be <code class="docutils literal notranslate"><span class="pre">np.float</span></code>.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.add_components">
<code class="sig-name descname">add_components</code><span class="sig-paren">(</span><em class="sig-param">components</em>, <em class="sig-param">init=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.add_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Add new components</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>components</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – new component names</p></li>
<li><p><strong>init</strong> (<em>array-like</em>) – initial component data</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – If a component or an attribute with the given name already exists</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.additive_noise">
<code class="sig-name descname">additive_noise</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">noise</em>, <em class="sig-param">clip=False</em>, <em class="sig-param">preserve_type=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.additive_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Add additive noise to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong> (<em>callable</em>) – Distribution. Must have <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter.</p></li>
<li><p><strong>clip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to force image’s pixels to be in [0, 255] or [0, 1.]</p></li>
<li><p><strong>preserve_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to preserve <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of transformed images.
If <code class="docutils literal notranslate"><span class="pre">False</span></code> is given then the resulting type will be <code class="docutils literal notranslate"><span class="pre">np.float</span></code>.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.apply_transform">
<code class="sig-name descname">apply_transform</code><span class="sig-paren">(</span><em class="sig-param">ix</em>, <em class="sig-param">func</em>, <em class="sig-param">*args</em>, <em class="sig-param">src=None</em>, <em class="sig-param">dst=None</em>, <em class="sig-param">p=None</em>, <em class="sig-param">use_self=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.apply_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a function to each item in the batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – a function to apply to each item from the source</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>sequence</em><em>, </em><em>list of str</em>) – <p>the source to get data from, can be:</p>
<ul>
<li><p>None</p></li>
<li><p>str - a component name, e.g. ‘images’ or ‘masks’</p></li>
<li><p>sequence - a numpy-array, list, etc</p></li>
<li><p>tuple of str - get data from several components</p></li>
<li><p>list of str, sequences or tuples - apply same transform to each item in list</p></li>
</ul>
</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>array</em>) – <p>the destination to put the result in, can be:</p>
<ul>
<li><p>None - in this case dst is set to be same as src</p></li>
<li><p>str - a component name, e.g. ‘images’ or ‘masks’</p></li>
<li><p>tuple of list of str, e.g. [‘images’, ‘masks’]</p></li>
</ul>
<p>if src is a list, dst should be either list or None.</p>
</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – <p>probability of applying transform to an element in the batch</p>
<p>if not None, indices of relevant batch elements will be passed <code class="docutils literal notranslate"><span class="pre">func</span></code>
as a named arg <code class="docutils literal notranslate"><span class="pre">indices</span></code>.</p>
</p></li>
<li><p><strong>use_self</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to pass <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">func</span></code></p></li>
<li><p><strong>kwargs</strong> (<em>args</em><em>,</em>) – other parameters passed to <code class="docutils literal notranslate"><span class="pre">func</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>apply_transform does the following (but in parallel):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dst</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">[</span><span class="n">item</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>If <cite>src</cite> is a list with two or more elements, <cite>dst</cite> should be list or
tuple of the same lenght.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apply_transform</span><span class="p">(</span><span class="n">make_masks_fn</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="s1">&#39;masks&#39;</span><span class="p">)</span>
<span class="n">apply_transform</span><span class="p">(</span><span class="n">apply_mask</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">),</span> <span class="n">dst</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="n">use_self</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">apply_transform_all</span><span class="p">(</span><span class="n">rotate</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">],</span> <span class="n">dst</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="s1">&#39;masks&#39;</span><span class="p">],</span> <span class="n">p</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.apply_transform_all">
<code class="sig-name descname">apply_transform_all</code><span class="sig-paren">(</span><em class="sig-param">func</em>, <em class="sig-param">*args</em>, <em class="sig-param">src=None</em>, <em class="sig-param">dst=None</em>, <em class="sig-param">p=None</em>, <em class="sig-param">use_self=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.apply_transform_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a function the whole batch at once</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> (<em>callable</em>) – a function to apply to each item from the source</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>array</em>) – <p>the source to get data from, can be:</p>
<ul>
<li><p>str - a component name, e.g. ‘images’ or ‘masks’</p></li>
<li><p>array-like - a numpy-array, list, etc</p></li>
</ul>
</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>array</em>) – <p>the destination to put the result in, can be:</p>
<ul>
<li><p>None</p></li>
<li><p>str - a component name, e.g. ‘images’ or ‘masks’</p></li>
<li><p>array-like - a numpy-array, list, etc</p></li>
</ul>
</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – <p>probability of applying transform to an element in the batch</p>
<p>if not None, indices of relevant batch elements will be passed <code class="docutils literal notranslate"><span class="pre">func</span></code>
as a named arg <code class="docutils literal notranslate"><span class="pre">indices</span></code>.</p>
</p></li>
<li><p><strong>use_self</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to pass <code class="docutils literal notranslate"><span class="pre">self</span></code> to <code class="docutils literal notranslate"><span class="pre">func</span></code></p></li>
<li><p><strong>kwargs</strong> (<em>args</em><em>,</em>) – other parameters passed to <code class="docutils literal notranslate"><span class="pre">func</span></code></p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>apply_transform_all does the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">p</span></code> is passed, random indices are chosen first and then passed to <code class="docutils literal notranslate"><span class="pre">func</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">random_indices</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>Transform functions might be methods as well, when <code class="docutils literal notranslate"><span class="pre">use_self=True</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">apply_transform_all</span><span class="p">(</span><span class="n">make_masks_fn</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="s1">&#39;masks&#39;</span><span class="p">)</span>
<span class="n">apply_transform_all</span><span class="p">(</span><span class="n">MyBatch</span><span class="o">.</span><span class="n">make_masks</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="s1">&#39;masks&#39;</span><span class="p">,</span> <span class="n">use_self</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">apply_transform_all</span><span class="p">(</span><span class="n">custom_crop</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="s1">&#39;images&#39;</span><span class="p">,</span> <span class="n">dst</span><span class="o">=</span><span class="s1">&#39;augmented_images&#39;</span><span class="p">,</span> <span class="n">p</span><span class="o">=.</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.array_of_nones">
<em class="property">property </em><code class="sig-name descname">array_of_nones</code><a class="headerlink" href="#batchflow.ImagesBatch.array_of_nones" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">NumPy</span></code> array with <code class="docutils literal notranslate"><span class="pre">None</span></code> values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>1-D ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.as_dataset">
<code class="sig-name descname">as_dataset</code><span class="sig-paren">(</span><em class="sig-param">dataset</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.as_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Makes a new dataset from batch data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset</strong> – an instance or a subclass of Dataset</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>an instance of a class specified by <cite>dataset</cite> arg, preloaded with this batch data</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.clip">
<code class="sig-name descname">clip</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">low=0</em>, <em class="sig-param">high=255</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.clip" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate image’s pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>low</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>sequence</em>) – Actual pixel’s value is equal max(value, low). If sequence is given, then its length must coincide
with the number of channels in an image and each channel is thresholded separately</p></li>
<li><p><strong>high</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>sequence</em>) – Actual pixel’s value is equal min(value, high). If sequence is given, then its length must coincide
with the number of channels in an image and each channel is thresholded separately</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="batchflow.ImagesBatch.components">
<code class="sig-name descname">components</code><em class="property"> = ('images', 'labels', 'masks')</em><a class="headerlink" href="#batchflow.ImagesBatch.components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.create_attrs">
<code class="sig-name descname">create_attrs</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.create_attrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create attributes from kwargs</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.crop">
<code class="sig-name descname">crop</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">origin</em>, <em class="sig-param">shape</em>, <em class="sig-param">crop_boundaries=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.crop" title="Permalink to this definition">¶</a></dt>
<dd><p>Crop an image.</p>
<p>Extract image data from the window of the size given by <cite>shape</cite> and placed at <cite>origin</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>sequence</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p>Location of the cropping box. Can be one of:
- ‘center’ - place the center of the input image on the center of the background and crop</p>
<blockquote>
<div><p>the input image accordingly.</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>’top_left’ - place the upper-left corner of the input image on the upper-left of the background</dt><dd><p>and crop the input image accordingly.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’top_right’ - crop an image such that upper-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_left’ - crop an image such that lower-left corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_right’ - crop an image such that lower-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’random’ - place the upper-left corner of the input image on the randomly sampled position</dt><dd><p>in the background. Position is sampled uniformly such that there is no need for cropping.</p>
</dd>
</dl>
</li>
<li><p>array_like - place the upper-left corner of the input image on the given position in the background.</p></li>
</ul>
</p></li>
<li><p><strong>shape</strong> (<em>sequence</em>) – <ul>
<li><p>sequence - crop size in the form of (rows, columns)</p></li>
</ul>
</p></li>
<li><p><strong>crop_boundaries</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If <cite>True</cite> then crop is got only from image’s area. Shape of the crop might diverge with the passed one</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Using ‘random’ origin with <cite>src</cite> as list with multiple elements will not result in same crop for each
element, as origin will be sampled independently for each <cite>src</cite> element.
To randomly sample same origin for a number of components, use <cite>R</cite> named expression for <cite>origin</cite> argument.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.cutout">
<code class="sig-name descname">cutout</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">origin</em>, <em class="sig-param">shape</em>, <em class="sig-param">color</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.cutout" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills given areas with color</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is assumed that <code class="docutils literal notranslate"><span class="pre">origins</span></code>, <code class="docutils literal notranslate"><span class="pre">shapes</span></code> and <code class="docutils literal notranslate"><span class="pre">colors</span></code> have the same length.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin</strong> (<em>sequence</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p>Location of the cropping box. Can be one of:
- ‘top_left’ - crop an image such that upper-left corners of</p>
<blockquote>
<div><p>an image and the filled box coincide.</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>’top_right’ - crop an image such that upper-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_left’ - crop an image such that lower-left corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_right’ - crop an image such that lower-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’center’ - crop an image such that centers of</dt><dd><p>an image and the filled box coincide.</p>
</dd>
</dl>
</li>
<li><p>’random’ - place the upper-left corner of the filled box at a random position.</p></li>
<li><p>array_like - place the upper-left corner of the input image on the given position in the background.</p></li>
</ul>
</p></li>
<li><p><strong>shape</strong> (<em>sequence</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – <p>Shape of a filled box. Can be one of:</p>
<ul>
<li><p>sequence - crop size in the form of (rows, columns)</p></li>
<li><p>int - shape has squared form</p></li>
</ul>
</p></li>
<li><p><strong>color</strong> (<em>sequence</em><em>, </em><em>number</em>) – <p>Color of a filled box. Can be one of:</p>
<ul>
<li><p>sequence - (r,g,b) form</p></li>
<li><p>number - grayscale</p></li>
</ul>
</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Using ‘random’ origin with <cite>src</cite> as list with multiple elements will not result in same crop for each
element, as origin will be sampled independently for each <cite>src</cite> element.
To randomly sample same origin for a number of components, use <cite>R</cite> named expression for <cite>origin</cite> argument.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.data">
<em class="property">property </em><code class="sig-name descname">data</code><a class="headerlink" href="#batchflow.ImagesBatch.data" title="Permalink to this definition">¶</a></dt>
<dd><p>tuple or named components - batch data</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.deepcopy">
<code class="sig-name descname">deepcopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a deep copy of the batch.</p>
<p>Constructs a new <code class="docutils literal notranslate"><span class="pre">Batch</span></code> instance and then recursively copies all
the objects found in the original batch, except the <code class="docutils literal notranslate"><span class="pre">pipeline</span></code>,
which remains unchanged.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="batchflow.batch.html#batchflow.Batch" title="batchflow.Batch">Batch</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.do_nothing">
<code class="sig-name descname">do_nothing</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.do_nothing" title="Permalink to this definition">¶</a></dt>
<dd><p>An empty action (might be convenient in complicated pipelines)</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.dump">
<code class="sig-name descname">dump</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">dst=None</em>, <em class="sig-param">fmt=None</em>, <em class="sig-param">components='images'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Dump data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <cite>fmt=’images’</cite> than <code class="docutils literal notranslate"><span class="pre">dst</span></code> must be a single component (str).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All parameters must be named only.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – Path to the folder where to dump. If dst is None then path is determined from the index.</p></li>
<li><p><strong>fmt</strong> (<em>{'image'</em><em>, </em><em>'blosc'</em><em>, </em><em>'csv'</em><em>, </em><em>'hdf5'</em><em>, </em><em>'feather'}</em>) – Format of the file to save.</p></li>
<li><p><strong>components</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>sequence</em>) – Components to save.</p></li>
<li><p><strong>ext</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Format to save images to.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.elastic_transform">
<code class="sig-name descname">elastic_transform</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">alpha</em>, <em class="sig-param">sigma</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.elastic_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Elastic deformation of images as described in <span id="id1">[Simard2003]</span>.
[Simard2003] Simard, Steinkraus and Platt, “Best Practices for
Convolutional Neural Networks applied to Visual Document Analysis”, in
Proc. of the International Conference on Document Analysis and
Recognition, 2003.</p>
<p>Code slightly differs with <a class="reference external" href="https://gist.github.com/chsasank/4d8f68caf01f041a6453e67fb30f8f5a">https://gist.github.com/chsasank/4d8f68caf01f041a6453e67fb30f8f5a</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>number</em>) – maximum of vectors’ norms.</p></li>
<li><p><strong>sigma</strong> (<em>number</em>) – Smooth factor.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.enhance">
<code class="sig-name descname">enhance</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">layout='hcbs'</em>, <em class="sig-param">factor=(1</em>, <em class="sig-param">1</em>, <em class="sig-param">1</em>, <em class="sig-param">1)</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.enhance" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply enhancements from PIL.ImageEnhance to the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – defines layout of operations, default is <cite>hcbs</cite>:
h - color
c - contrast
b - brightness
s - sharpness</p></li>
<li><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>tuple of float</em>) – factor of enhancement for each operation listed in <cite>layout</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.filter">
<code class="sig-name descname">filter</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">mode</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Filters an image. Calls image.filter(getattr(PIL.ImageFilter, mode)(<a href="#id2"><span class="problematic" id="id3">*</span></a>args, <a href="#id4"><span class="problematic" id="id5">**</span></a>kwargs))</p>
<p>For more details see <a class="reference external" href="http://pillow.readthedocs.io/en/stable/reference/ImageFilter.html">http://pillow.readthedocs.io/en/stable/reference/ImageFilter.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of the filter.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.flip">
<code class="sig-name descname">flip</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">mode='lr'</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.flip" title="Permalink to this definition">¶</a></dt>
<dd><p>Flips image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>{'lr'</em><em>, </em><em>'ud'}</em>) – <ul>
<li><p>‘lr’ - apply the left/right flip</p></li>
<li><p>’ud’ - apply the upside/down flip</p></li>
</ul>
</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="batchflow.ImagesBatch.formats">
<code class="sig-name descname">formats</code><em class="property"> = {'JPEG', 'JPG', 'PNG', 'jpeg', 'jpg', 'png'}</em><a class="headerlink" href="#batchflow.ImagesBatch.formats" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="batchflow.ImagesBatch.formats_lower">
<code class="sig-name descname">formats_lower</code><em class="property"> = ['jpg', 'png', 'jpeg']</em><a class="headerlink" href="#batchflow.ImagesBatch.formats_lower" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.from_batch">
<em class="property">classmethod </em><code class="sig-name descname">from_batch</code><span class="sig-paren">(</span><em class="sig-param">batch</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.from_batch" title="Permalink to this definition">¶</a></dt>
<dd><p>Create batch from another batch</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.from_data">
<em class="property">classmethod </em><code class="sig-name descname">from_data</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.from_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Create batch from a given dataset</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">item=None</em>, <em class="sig-param">component=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an item from the batch or the component</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.get_errors">
<code class="sig-name descname">get_errors</code><span class="sig-paren">(</span><em class="sig-param">all_res</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.get_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of errors from a parallel action</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.get_items">
<code class="sig-name descname">get_items</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">data=None</em>, <em class="sig-param">components=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.get_items" title="Permalink to this definition">¶</a></dt>
<dd><p>Return one or several data items from a data source</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.get_model_by_name">
<code class="sig-name descname">get_model_by_name</code><span class="sig-paren">(</span><em class="sig-param">model_name</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.get_model_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a model specification given its name</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.image_shape">
<em class="property">property </em><code class="sig-name descname">image_shape</code><a class="headerlink" href="#batchflow.ImagesBatch.image_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>tuple - shape of the image</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.indices">
<em class="property">property </em><code class="sig-name descname">indices</code><a class="headerlink" href="#batchflow.ImagesBatch.indices" title="Permalink to this definition">¶</a></dt>
<dd><p>numpy array - an array with the indices</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.invert">
<code class="sig-name descname">invert</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">channels='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.invert" title="Permalink to this definition">¶</a></dt>
<dd><p>Invert givn channels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>sequence</em>) – Indices of the channels to invert.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.items">
<em class="property">property </em><code class="sig-name descname">items</code><a class="headerlink" href="#batchflow.ImagesBatch.items" title="Permalink to this definition">¶</a></dt>
<dd><p>list - batch items</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">src=None</em>, <em class="sig-param">fmt=None</em>, <em class="sig-param">dst=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if <cite>fmt=’images’</cite> than <code class="docutils literal notranslate"><span class="pre">components</span></code> must be a single component (str).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All parameters must be named only.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – Path to the folder with data. If src is None then path is determined from the index.</p></li>
<li><p><strong>fmt</strong> (<em>{'image'</em><em>, </em><em>'blosc'</em><em>, </em><em>'csv'</em><em>, </em><em>'hdf5'</em><em>, </em><em>'feather'}</em>) – Format of the file to download.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>sequence</em>) – components to download.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.make_item_class">
<code class="sig-name descname">make_item_class</code><span class="sig-paren">(</span><em class="sig-param">local=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.make_item_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a class to handle data components</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.merge">
<em class="property">classmethod </em><code class="sig-name descname">merge</code><span class="sig-paren">(</span><em class="sig-param">batches</em>, <em class="sig-param">batch_size=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.merge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge several batches to form a new batch of a given size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batches</strong> (<em>tuple of batches</em>) – </p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – if <cite>None</cite>, just merge all batches into one batch (the rest will be <cite>None</cite>),
if <cite>int</cite>, then make one batch of <cite>batch_size</cite> and a batch with the rest of data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>batch, rest</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of two batches</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.7)"><strong>ValueError</strong></a> – If component is <cite>None</cite> in some batches and not <cite>None</cite> in others.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.merge_component">
<em class="property">classmethod </em><code class="sig-name descname">merge_component</code><span class="sig-paren">(</span><em class="sig-param">component=None</em>, <em class="sig-param">data=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.merge_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Merge the same component data from several batches</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.multiplicative_noise">
<code class="sig-name descname">multiplicative_noise</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">noise</em>, <em class="sig-param">clip=False</em>, <em class="sig-param">preserve_type=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.multiplicative_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Add multiplicativa noise to an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>noise</strong> (<em>callable</em>) – Distribution. Must have <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter.</p></li>
<li><p><strong>clip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to force image’s pixels to be in [0, 255] or [0, 1.]</p></li>
<li><p><strong>preserve_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to preserve <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of transformed images.
If <code class="docutils literal notranslate"><span class="pre">False</span></code> is given then the resulting type will be <code class="docutils literal notranslate"><span class="pre">np.float</span></code>.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.multiply">
<code class="sig-name descname">multiply</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">multiplier=1.0</em>, <em class="sig-param">clip=False</em>, <em class="sig-param">preserve_type=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.multiply" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiply each pixel by the given multiplier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>sequence</em>) – </p></li>
<li><p><strong>clip</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to force image’s pixels to be in [0, 255] or [0, 1.]</p></li>
<li><p><strong>preserve_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to preserve <code class="docutils literal notranslate"><span class="pre">dtype</span></code> of transformed images.
If <code class="docutils literal notranslate"><span class="pre">False</span></code> is given then the resulting type will be <code class="docutils literal notranslate"><span class="pre">np.float</span></code>.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.pad">
<code class="sig-name descname">pad</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls PIL.ImageOps.expand.</p>
<p>For more details see <a class="reference external" href="http://pillow.readthedocs.io/en/stable/reference/ImageOps.html#PIL.ImageOps.expand">http://pillow.readthedocs.io/en/stable/reference/ImageOps.html#PIL.ImageOps.expand</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>offset</strong> (<em>sequence</em>) – Size of the borders in pixels. The order is (left, top, right, bottom).</p></li>
<li><p><strong>mode</strong> (<em>{'const'</em><em>, </em><em>'wrap'}</em>) – Filling mode</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.pil_convert">
<code class="sig-name descname">pil_convert</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">mode='L'</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.pil_convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert image. Actually calls image.convert(mode)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Pass ‘L’ to convert to grayscale</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.pipeline">
<em class="property">property </em><code class="sig-name descname">pipeline</code><a class="headerlink" href="#batchflow.ImagesBatch.pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Pipeline - a pipeline the batch is being used in</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.posterize">
<code class="sig-name descname">posterize</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">bits=4</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.posterize" title="Permalink to this definition">¶</a></dt>
<dd><p>Posterizes image.</p>
<p>More concretely, it quantizes pixels’ values so that they have``2^bits`` colors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bits</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of bits used to store a color’s component.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.put_into_data">
<code class="sig-name descname">put_into_data</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">dst=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.put_into_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data into <code class="xref py py-attr docutils literal notranslate"><span class="pre">_data</span></code> property</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.put_on_background">
<code class="sig-name descname">put_on_background</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">background</em>, <em class="sig-param">origin</em>, <em class="sig-param">mask=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.put_on_background" title="Permalink to this definition">¶</a></dt>
<dd><p>Put an image on a background at given origin</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>background</strong> (<em>PIL.Image</em><em>, </em><em>np.ndarray of np.uint8</em>) – </p></li>
<li><p><strong>origin</strong> (<em>sequence</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – <p>Location of the cropping box. Can be one of:
- ‘center’ - place the center of the input image on the center of the background and crop</p>
<blockquote>
<div><p>the input image accordingly.</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>’top_left’ - place the upper-left corner of the input image on the upper-left of the background</dt><dd><p>and crop the input image accordingly.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’top_right’ - crop an image such that upper-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_left’ - crop an image such that lower-left corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_right’ - crop an image such that lower-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’random’ - place the upper-left corner of the input image on the randomly sampled position</dt><dd><p>in the background. Position is sampled uniformly such that there is no need for cropping.</p>
</dd>
</dl>
</li>
<li><p>array_like - place the upper-left corner of the input image on the given position in the background.</p></li>
</ul>
</p></li>
<li><p><strong>mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a><em>, </em><em>PIL.Image</em><em>, </em><em>np.ndarray of np.uint8</em>) – mask passed to PIL.Image.paste</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Using ‘random’ origin with <cite>src</cite> as list with multiple elements will not result in same crop for each
element, as origin will be sampled independently for each <cite>src</cite> element.
To randomly sample same origin for a number of components, use <cite>R</cite> named expression for <cite>origin</cite> argument.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.resize">
<code class="sig-name descname">resize</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls image.resize(<a href="#id6"><span class="problematic" id="id7">*</span></a>args, <a href="#id8"><span class="problematic" id="id9">**</span></a>kwargs)</p>
<p>For more details see <a class="reference external" href="https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.resize">https://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.resize</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.rotate">
<code class="sig-name descname">rotate</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotates an image.</p>
<blockquote>
<div><p>kwargs are passed to PIL.Image.rotate</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<em>Number</em>) – In degrees counter clockwise.</p></li>
<li><p><strong>resample</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Interpolation order</p></li>
<li><p><strong>expand</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to expand the output to hold the whole image. Default is False.</p></li>
<li><p><strong>center</strong> (<em>(</em><em>Number</em><em>, </em><em>Number</em><em>)</em>) – Center of rotation. Default is the center of the image.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.run_once">
<code class="sig-name descname">run_once</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.run_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Init function for no parallelism
Useful for async action-methods (will wait till the method finishes)</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.salt">
<code class="sig-name descname">salt</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">p_noise=0.015</em>, <em class="sig-param">color=255</em>, <em class="sig-param">size=(1</em>, <em class="sig-param">1)</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.salt" title="Permalink to this definition">¶</a></dt>
<dd><p>Set random pixel on image to givan value.</p>
<p>Every pixel will be set to <code class="docutils literal notranslate"><span class="pre">color</span></code> value with probability <code class="docutils literal notranslate"><span class="pre">p_noise</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of salting a pixel.</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>sequence</em><em>, </em><em>callable</em>) – <p>Color’s value.</p>
<ul>
<li><p>int, float, sequence – value of color</p></li>
<li><p>callable – color is sampled for every chosen pixel (rules are the same as for int, float and sequence)</p></li>
</ul>
</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>sequence of int</em><em>, </em><em>callable</em>) – <p>Size of salt</p>
<ul>
<li><p>int – square salt with side <code class="docutils literal notranslate"><span class="pre">size</span></code></p></li>
<li><p>sequence – recangular salt in the form (row, columns)</p></li>
<li><p>callable – size is sampled for every chosen pixel (rules are the same as for int and sequence)</p></li>
</ul>
</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save batch data to a file (an alias for dump method)</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.scale">
<code class="sig-name descname">scale</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">factor</em>, <em class="sig-param">preserve_shape=False</em>, <em class="sig-param">origin='center'</em>, <em class="sig-param">resample=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale the content of each image in the batch.</p>
<p>Resulting shape is obtained as original_shape * factor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>sequence</em>) – <p>resulting shape is obtained as original_shape * factor</p>
<ul>
<li><p>float - scale all axes with the given factor</p></li>
<li><p>sequence (factor_1, factort_2, …) - scale each axis with the given factor separately</p></li>
</ul>
</p></li>
<li><p><strong>preserve_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – whether to preserve the shape of the image after scaling</p></li>
<li><p><strong>origin</strong> (<em>array-like</em><em>, </em><em>{'center'</em><em>, </em><em>'top_left'</em><em>, </em><em>'top_right'</em><em>, </em><em>'bottom_left'</em><em>, </em><em>'bottom_right'</em><em>, </em><em>'random'}</em>) – <p>Relevant only if <cite>preserve_shape</cite> is True.
If <cite>scale</cite> &lt; 1, defines position of the scaled image with respect to the original one’s shape.
If <cite>scale</cite> &gt; 1, defines position of cropping box.
- ‘center’ - place the center of the input image on the center of the background and crop</p>
<blockquote>
<div><p>the input image accordingly.</p>
</div></blockquote>
<ul>
<li><dl class="simple">
<dt>’top_left’ - place the upper-left corner of the input image on the upper-left of the background</dt><dd><p>and crop the input image accordingly.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’top_right’ - crop an image such that upper-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_left’ - crop an image such that lower-left corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’bottom_right’ - crop an image such that lower-right corners of</dt><dd><p>an image and the cropping box coincide</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>’random’ - place the upper-left corner of the input image on the randomly sampled position</dt><dd><p>in the background. Position is sampled uniformly such that there is no need for cropping.</p>
</dd>
</dl>
</li>
<li><p>array_like - place the upper-left corner of the input image on the given position in the background.</p></li>
</ul>
</p></li>
<li><p><strong>resample</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Parameter passed to PIL.Image.resize. Interpolation order</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Using ‘random’ option for origin with <cite>src</cite> as list with multiple elements will not result in same crop for each
element, as origin will be sampled independently for each <cite>src</cite> element.
To randomly sample same origin for a number of components, use <cite>R</cite> named expression for <cite>origin</cite> argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>self</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.shift">
<code class="sig-name descname">shift</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">offset</em>, <em class="sig-param">mode='const'</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>offset</strong> (<em>(</em><em>Number</em><em>, </em><em>Number</em><em>)</em>) – </p></li>
<li><p><strong>mode</strong> (<em>{'const'</em><em>, </em><em>'wrap'}</em>) – How to fill borders</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.size">
<em class="property">property </em><code class="sig-name descname">size</code><a class="headerlink" href="#batchflow.ImagesBatch.size" title="Permalink to this definition">¶</a></dt>
<dd><p>int - number of items in the batch</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_affine_transform">
<code class="sig-name descname">sp_affine_transform</code><span class="sig-paren">(</span><em class="sig-param">matrix</em>, <em class="sig-param">offset=0.0</em>, <em class="sig-param">output_shape=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">order=3</em>, <em class="sig-param">mode='constant'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">prefilter=True</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_affine_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an affine transformation.</p>
<p>Given an output image pixel index vector <code class="docutils literal notranslate"><span class="pre">o</span></code>, the pixel value
is determined from the input image at position
<code class="docutils literal notranslate"><span class="pre">np.dot(matrix,</span> <span class="pre">o)</span> <span class="pre">+</span> <span class="pre">offset</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>matrix</strong> (<em>ndarray</em>) – <p>The inverse coordinate transformation matrix, mapping output
coordinates to input coordinates. If <code class="docutils literal notranslate"><span class="pre">ndim</span></code> is the number of
dimensions of <code class="docutils literal notranslate"><span class="pre">input</span></code>, the given matrix must have one of the
following shapes:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">(ndim,</span> <span class="pre">ndim)</span></code>: the linear transformation matrix for each
output coordinate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(ndim,)</span></code>: assume that the 2D transformation matrix is
diagonal, with the diagonal specified by the given value. A more
efficient algorithm is then used that exploits the separability
of the problem.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(ndim</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1)</span></code>: assume that the transformation is
specified using homogeneous coordinates <a href="#id56"><span class="problematic" id="id10">[1]_</span></a>. In this case, any
value passed to <code class="docutils literal notranslate"><span class="pre">offset</span></code> is ignored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(ndim,</span> <span class="pre">ndim</span> <span class="pre">+</span> <span class="pre">1)</span></code>: as above, but the bottom row of a
homogeneous transformation matrix is always <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0,</span> <span class="pre">...,</span> <span class="pre">1]</span></code>,
and may be omitted.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – The offset into the array where the transform is applied. If a float,
<cite>offset</cite> is the same for each axis. If a sequence, <cite>offset</cite> should
contain one value for each axis.</p></li>
<li><p><strong>output_shape</strong> (<em>tuple of ints</em><em>, </em><em>optional</em>) – Shape tuple.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline interpolation, default is 3.
The order has to be in the range 0-5.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>prefilter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the input array is prefiltered with <cite>spline_filter</cite>
before interpolation. The default is True, which will create a
temporary <cite>float64</cite> array of filtered values if <cite>order &gt; 1</cite>. If
setting this to False, the output will be slightly blurred if
<cite>order &gt; 1</cite>, unless the input is prefiltered, i.e. it is the result
of calling <cite>spline_filter</cite> on the original input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>affine_transform</strong> – The transformed input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The given matrix and offset are used to find for each point in the
output the corresponding coordinates in the input by an affine
transformation. The value of the input at those coordinates is
determined by spline interpolation of the requested order. Points
outside the boundaries of the input are filled according to the given
mode.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 0.18.0: </span>Previously, the exact interpretation of the affine transformation
depended on whether the matrix was supplied as a one-dimensional or
two-dimensional array. If a one-dimensional array was supplied
to the matrix parameter, the output pixel value at index <code class="docutils literal notranslate"><span class="pre">o</span></code>
was determined from the input image at position
<code class="docutils literal notranslate"><span class="pre">matrix</span> <span class="pre">*</span> <span class="pre">(o</span> <span class="pre">+</span> <span class="pre">offset)</span></code>.</p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id11"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Homogeneous_coordinates">https://en.wikipedia.org/wiki/Homogeneous_coordinates</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_closing">
<code class="sig-name descname">sp_binary_closing</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">origin=0</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">border_value=0</em>, <em class="sig-param">brute_force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_closing" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional binary closing with the given structuring element.</p>
<p>The <em>closing</em> of an input image by a structuring element is the
<em>erosion</em> of the <em>dilation</em> of the image by the structuring element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Binary array_like to be closed. Non-zero (True) elements form
the subset to be closed.</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Structuring element used for the closing. Non-zero elements are
considered True. If no structuring element is provided an element
is generated with a square connectivity equal to one (i.e., only
nearest neighbors are connected to the center, diagonally-connected
elements are not considered neighbors).</p></li>
<li><p><strong>iterations</strong> (<em>{int</em><em>, </em><em>float}</em><em>, </em><em>optional</em>) – The dilation step of the closing, then the erosion step are each
repeated <cite>iterations</cite> times (one, by default). If iterations is
less than 1, each operations is repeated until the result does
not change anymore.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the filter, by default 0.</p></li>
<li><p><strong>mask</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>If a mask is given, only those elements with a True value at
the corresponding mask element are modified at each iteration.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
</p></li>
<li><p><strong>border_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>cast to 0</em><em> or </em><em>1</em><em>)</em><em>, </em><em>optional</em>) – <p>Value at the border in the output array.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
</p></li>
<li><p><strong>brute_force</strong> (<em>boolean</em><em>, </em><em>optional</em>) – <p>Memory condition: if False, only the pixels whose value was changed in
the last iteration are tracked as candidates to be updated in the
current iteration; if true al pixels are considered as candidates for
update, regardless of what happened in the previous iteration.
False by default.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_closing</strong> – Closing of the input by the structuring element.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray of bools</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p><em>Closing</em> <a href="#id57"><span class="problematic" id="id12">[1]_</span></a> is a mathematical morphology operation <a href="#id58"><span class="problematic" id="id13">[2]_</span></a> that
consists in the succession of a dilation and an erosion of the
input with the same structuring element. Closing therefore fills
holes smaller than the structuring element.</p>
<p>Together with <em>opening</em> (<cite>binary_opening</cite>), closing can be used for
noise removal.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id14"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Closing_%28morphology%29">https://en.wikipedia.org/wiki/Closing_%28morphology%29</a></p>
</dd>
<dt class="label" id="id15"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 0, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Closing removes small holes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Closing is the erosion of the dilation of the input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 1, 1, 1, 0],</span>
<span class="go">       [1, 1, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 1, 1],</span>
<span class="go">       [0, 1, 1, 1, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># In addition to removing holes, closing can also</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># coarsen boundaries with fine hollows.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_closing</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_dilation">
<code class="sig-name descname">sp_binary_dilation</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">border_value=0</em>, <em class="sig-param">origin=0</em>, <em class="sig-param">brute_force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_dilation" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional binary dilation with the given structuring element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Binary array_like to be dilated. Non-zero (True) elements form
the subset to be dilated.</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Structuring element used for the dilation. Non-zero elements are
considered True. If no structuring element is provided an element
is generated with a square connectivity equal to one.</p></li>
<li><p><strong>iterations</strong> (<em>{int</em><em>, </em><em>float}</em><em>, </em><em>optional</em>) – The dilation is repeated <cite>iterations</cite> times (one, by default).
If iterations is less than 1, the dilation is repeated until the
result does not change anymore.</p></li>
<li><p><strong>mask</strong> (<em>array_like</em><em>, </em><em>optional</em>) – If a mask is given, only those elements with a True value at
the corresponding mask element are modified at each iteration.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>border_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>cast to 0</em><em> or </em><em>1</em><em>)</em><em>, </em><em>optional</em>) – Value at the border in the output array.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the filter, by default 0.</p></li>
<li><p><strong>brute_force</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Memory condition: if False, only the pixels whose value was changed in
the last iteration are tracked as candidates to be updated (dilated)
in the current iteration; if True all pixels are considered as
candidates for dilation, regardless of what happened in the previous
iteration. False by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_dilation</strong> – Dilation of the input by the structuring element.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray of bools</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>Dilation <a href="#id59"><span class="problematic" id="id16">[1]_</span></a> is a mathematical morphology operation <a href="#id60"><span class="problematic" id="id17">[2]_</span></a> that uses a
structuring element for expanding the shapes in an image. The binary
dilation of an image by a structuring element is the locus of the points
covered by the structuring element, when its center lies within the
non-zero points of the image.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id18"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Dilation_%28morphology%29">https://en.wikipedia.org/wiki/Dilation_%28morphology%29</a></p>
</dd>
<dt class="label" id="id19"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">array([[False, False, False, False, False],</span>
<span class="go">       [False, False,  True, False, False],</span>
<span class="go">       [False,  True,  True,  True, False],</span>
<span class="go">       [False, False,  True, False, False],</span>
<span class="go">       [False, False, False, False, False]], dtype=bool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3x3 structuring element with connectivity 1, used by default</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struct1</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struct1</span>
<span class="go">array([[False,  True, False],</span>
<span class="go">       [ True,  True,  True],</span>
<span class="go">       [False,  True, False]], dtype=bool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># 3x3 structuring element with connectivity 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struct2</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struct2</span>
<span class="go">array([[ True,  True,  True],</span>
<span class="go">       [ True,  True,  True],</span>
<span class="go">       [ True,  True,  True]], dtype=bool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">struct1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">struct2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  0.,  0.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">struct1</span><span class="p">,</span>\
<span class="gp">... </span><span class="n">iterations</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">array([[ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 1.,  1.,  1.,  1.,  1.],</span>
<span class="go">       [ 0.,  1.,  1.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_erosion">
<code class="sig-name descname">sp_binary_erosion</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">border_value=0</em>, <em class="sig-param">origin=0</em>, <em class="sig-param">brute_force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_erosion" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional binary erosion with a given structuring element.</p>
<p>Binary erosion is a mathematical morphology operation used for image
processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Binary image to be eroded. Non-zero (True) elements form
the subset to be eroded.</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Structuring element used for the erosion. Non-zero elements are
considered True. If no structuring element is provided, an element
is generated with a square connectivity equal to one.</p></li>
<li><p><strong>iterations</strong> (<em>{int</em><em>, </em><em>float}</em><em>, </em><em>optional</em>) – The erosion is repeated <cite>iterations</cite> times (one, by default).
If iterations is less than 1, the erosion is repeated until the
result does not change anymore.</p></li>
<li><p><strong>mask</strong> (<em>array_like</em><em>, </em><em>optional</em>) – If a mask is given, only those elements with a True value at
the corresponding mask element are modified at each iteration.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>border_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>cast to 0</em><em> or </em><em>1</em><em>)</em><em>, </em><em>optional</em>) – Value at the border in the output array.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the filter, by default 0.</p></li>
<li><p><strong>brute_force</strong> (<em>boolean</em><em>, </em><em>optional</em>) – Memory condition: if False, only the pixels whose value was changed in
the last iteration are tracked as candidates to be updated (eroded) in
the current iteration; if True all pixels are considered as candidates
for erosion, regardless of what happened in the previous iteration.
False by default.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_erosion</strong> – Erosion of the input by the structuring element.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray of bools</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>Erosion <a href="#id61"><span class="problematic" id="id20">[1]_</span></a> is a mathematical morphology operation <a href="#id62"><span class="problematic" id="id21">[2]_</span></a> that uses a
structuring element for shrinking the shapes in an image. The binary
erosion of an image by a structuring element is the locus of the points
where a superimposition of the structuring element centered on the point
is entirely contained in the set of non-zero elements of the image.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id22"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Erosion_%28morphology%29">https://en.wikipedia.org/wiki/Erosion_%28morphology%29</a></p>
</dd>
<dt class="label" id="id23"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#Erosion removes objects smaller than the structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_fill_holes">
<code class="sig-name descname">sp_binary_fill_holes</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_fill_holes" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the holes in binary objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – n-dimensional binary array with holes to be filled</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Structuring element used in the computation; large-size elements
make computations faster but may miss holes separated from the
background by thin regions. The default element (with a square
connectivity equal to one) yields the intuitive result where all
holes in the input have been filled.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Position of the structuring element.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Transformation of the initial image <cite>input</cite> where holes have been
filled.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_propagation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The algorithm used in this function consists in invading the complementary
of the shapes in <cite>input</cite> from the outer boundary of the image,
using binary dilations. Holes are not connected to the boundary and are
therefore not invaded. The result is the complementary subset of the
invaded region.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id24"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 0, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_fill_holes</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Too big structuring element</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_fill_holes</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 0, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_hit_or_miss">
<code class="sig-name descname">sp_binary_hit_or_miss</code><span class="sig-paren">(</span><em class="sig-param">structure1=None</em>, <em class="sig-param">structure2=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">origin1=0</em>, <em class="sig-param">origin2=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_hit_or_miss" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional binary hit-or-miss transform.</p>
<p>The hit-or-miss transform finds the locations of a given pattern
inside the input image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em><em> (</em><em>cast to booleans</em><em>)</em>) – Binary image where a pattern is to be detected.</p></li>
<li><p><strong>structure1</strong> (<em>array_like</em><em> (</em><em>cast to booleans</em><em>)</em><em>, </em><em>optional</em>) – Part of the structuring element to be fitted to the foreground
(non-zero elements) of <cite>input</cite>. If no value is provided, a
structure of square connectivity 1 is chosen.</p></li>
<li><p><strong>structure2</strong> (<em>array_like</em><em> (</em><em>cast to booleans</em><em>)</em><em>, </em><em>optional</em>) – Second part of the structuring element that has to miss completely
the foreground. If no value is provided, the complementary of
<cite>structure1</cite> is taken.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>origin1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the first part of the structuring element <cite>structure1</cite>,
by default 0 for a centered structure.</p></li>
<li><p><strong>origin2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the second part of the structuring element <cite>structure2</cite>,
by default 0 for a centered structure. If a value is provided for
<cite>origin1</cite> and not for <cite>origin2</cite>, then <cite>origin2</cite> is set to <cite>origin1</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_hit_or_miss</strong> – Hit-or-miss transform of <cite>input</cite> with the given structuring
element (<cite>structure1</cite>, <cite>structure2</cite>).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.morphology()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_erosion()</span></code></p>
</div>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id25"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Hit-or-miss_transform">https://en.wikipedia.org/wiki/Hit-or-miss_transform</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structure1</span>
<span class="go">array([[1, 0, 0],</span>
<span class="go">       [0, 1, 1],</span>
<span class="go">       [0, 1, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Find the matches of structure1 in the array a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_hit_or_miss</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure1</span><span class="o">=</span><span class="n">structure1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Change the origin of the filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># origin1=1 is equivalent to origin1=(1,1) here</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_hit_or_miss</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure1</span><span class="o">=</span><span class="n">structure1</span><span class="p">,</span>\
<span class="gp">... </span><span class="n">origin1</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_opening">
<code class="sig-name descname">sp_binary_opening</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">iterations=1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">origin=0</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">border_value=0</em>, <em class="sig-param">brute_force=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_opening" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional binary opening with the given structuring element.</p>
<p>The <em>opening</em> of an input image by a structuring element is the
<em>dilation</em> of the <em>erosion</em> of the image by the structuring element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Binary array_like to be opened. Non-zero (True) elements form
the subset to be opened.</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Structuring element used for the opening. Non-zero elements are
considered True. If no structuring element is provided an element
is generated with a square connectivity equal to one (i.e., only
nearest neighbors are connected to the center, diagonally-connected
elements are not considered neighbors).</p></li>
<li><p><strong>iterations</strong> (<em>{int</em><em>, </em><em>float}</em><em>, </em><em>optional</em>) – The erosion step of the opening, then the dilation step are each
repeated <cite>iterations</cite> times (one, by default). If <cite>iterations</cite> is
less than 1, each operation is repeated until the result does
not change anymore.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the filter, by default 0.</p></li>
<li><p><strong>mask</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>If a mask is given, only those elements with a True value at
the corresponding mask element are modified at each iteration.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
</p></li>
<li><p><strong>border_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>cast to 0</em><em> or </em><em>1</em><em>)</em><em>, </em><em>optional</em>) – <p>Value at the border in the output array.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
</p></li>
<li><p><strong>brute_force</strong> (<em>boolean</em><em>, </em><em>optional</em>) – <p>Memory condition: if False, only the pixels whose value was changed in
the last iteration are tracked as candidates to be updated in the
current iteration; if true all pixels are considered as candidates for
update, regardless of what happened in the previous iteration.
False by default.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.1.0.</span></p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_opening</strong> – Opening of the input by the structuring element.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray of bools</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p><em>Opening</em> <a href="#id63"><span class="problematic" id="id26">[1]_</span></a> is a mathematical morphology operation <a href="#id64"><span class="problematic" id="id27">[2]_</span></a> that
consists in the succession of an erosion and a dilation of the
input with the same structuring element. Opening therefore removes
objects smaller than the structuring element.</p>
<p>Together with <em>closing</em> (<cite>binary_closing</cite>), opening can be used for
noise removal.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id28"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Opening_%28morphology%29">https://en.wikipedia.org/wiki/Opening_%28morphology%29</a></p>
</dd>
<dt class="label" id="id29"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening removes small objects</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening can also smooth corners</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Opening is the dilation of the erosion of the input</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_dilation</span><span class="p">(</span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_binary_propagation">
<code class="sig-name descname">sp_binary_propagation</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">mask=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">border_value=0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_binary_propagation" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional binary propagation with the given structuring element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Binary image to be propagated inside <cite>mask</cite>.</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Structuring element used in the successive dilations. The output
may depend on the structuring element, especially if <cite>mask</cite> has
several connex components. If no structuring element is
provided, an element is generated with a squared connectivity equal
to one.</p></li>
<li><p><strong>mask</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Binary mask defining the region into which <cite>input</cite> is allowed to
propagate.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Array of the same shape as input, into which the output is placed.
By default, a new array is created.</p></li>
<li><p><strong>border_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> (</em><em>cast to 0</em><em> or </em><em>1</em><em>)</em><em>, </em><em>optional</em>) – Value at the border in the output array.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>tuple of ints</em><em>, </em><em>optional</em>) – Placement of the filter, by default 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>binary_propagation</strong> – Binary propagation of <cite>input</cite> inside <cite>mask</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is functionally equivalent to calling binary_dilation
with the number of iterations less than one: iterative dilation until
the result does not change anymore.</p>
<p>The succession of an erosion and propagation inside the original image
can be used instead of an <em>opening</em> for deleting small objects while
keeping the contours of larger objects untouched.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id30"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="http://cmm.ensmp.fr/~serra/cours/pdf/en/ch6en.pdf">http://cmm.ensmp.fr/~serra/cours/pdf/en/ch6en.pdf</a>, slide 15.</p>
</dd>
<dt class="label" id="id31"><span class="brackets">2</span></dt>
<dd><p>I.T. Young, J.J. Gerbrands, and L.J. van Vliet, “Fundamentals of
image processing”, 1998
<a class="reference external" href="ftp://qiftp.tudelft.nl/DIPimage/docs/FIP2.3.pdf">ftp://qiftp.tudelft.nl/DIPimage/docs/FIP2.3.pdf</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>  <span class="o">=</span> <span class="n">mask</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mask</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 1, 1],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 1, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_propagation</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_propagation</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span>\
<span class="gp">... </span><span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 1, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Comparison between opening and erosion+propagation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[1, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_opening</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">binary_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">binary_propagation</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_black_tophat">
<code class="sig-name descname">sp_black_tophat</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_black_tophat" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional black tophat filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em><em>, </em><em>optional</em>) – Shape of a flat and full structuring element used for the filter.
Optional if <cite>footprint</cite> or <cite>structure</cite> is provided.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of non-infinite elements of a flat structuring element
used for the black tophat filter.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the filter. <cite>structure</cite>
may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the filter may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>black_tophat</strong> – Result of the filter of <cite>input</cite> with <cite>structure</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">white_tophat()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_closing()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_center_of_mass">
<code class="sig-name descname">sp_center_of_mass</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_center_of_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the center of mass of the values of an array at labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>ndarray</em>) – Data from which to calculate center-of-mass. The masses can either
be positive or negative.</p></li>
<li><p><strong>labels</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Labels for objects in <cite>input</cite>, as generated by <cite>ndimage.label</cite>.
Only used with <cite>index</cite>.  Dimensions must be the same as <cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – Labels for which to calculate centers-of-mass. If not specified,
all labels greater than zero are used.  Only used with <cite>labels</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>center_of_mass</strong> – Coordinates of centers-of-mass.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a>, or list of tuples</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(2.0, 1.5)</span>
</pre></div>
</div>
<p>Calculation of multiple objects in an image</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lbl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">b</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[(0.33333333333333331, 1.3333333333333333), (3.5, 2.5)]</span>
</pre></div>
</div>
<p>Negative masses are also accepted, which can occur for example when
bias is removed from measured data due to random noise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="go">(-4.0, 1.0)</span>
</pre></div>
</div>
<p>If there are division by zero issues, the function does not raise an
error but rather issues a RuntimeWarning before returning inf and/or NaN.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">center_of_mass</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="go">(inf,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_convolve">
<code class="sig-name descname">sp_convolve</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_convolve" title="Permalink to this definition">¶</a></dt>
<dd><p>Multidimensional convolution.</p>
<p>The array is convolved with the given kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>weights</strong> (<em>array_like</em>) – Array of weights, same number of dimensions as input</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – The result of convolution of <cite>input</cite> with <cite>weights</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">correlate()</span></code></dt><dd><p>Correlate an image with a kernel.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Each value in result is <span class="math notranslate nohighlight">\(C_i = \sum_j{I_{i+k-j} W_j}\)</span>, where
W is the <cite>weights</cite> kernel,
j is the n-D spatial index over <span class="math notranslate nohighlight">\(W\)</span>,
I is the <cite>input</cite> and k is the coordinate of the center of
W, specified by <cite>origin</cite> in the input parameters.</p>
<p class="rubric">Examples</p>
<p>Perhaps the simplest case to understand is <code class="docutils literal notranslate"><span class="pre">mode='constant',</span> <span class="pre">cval=0.0</span></code>,
because in this case borders (i.e. where the <cite>weights</cite> kernel, centered
on any one value, extends beyond an edge of <cite>input</cite>) are treated as zeros.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">cval</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="go">array([[11, 10,  7,  4],</span>
<span class="go">       [10,  3, 11, 11],</span>
<span class="go">       [15, 12, 14,  7],</span>
<span class="go">       [12,  3,  7,  0]])</span>
</pre></div>
</div>
<p>Setting <code class="docutils literal notranslate"><span class="pre">cval=1.0</span></code> is equivalent to padding the outer edge of <cite>input</cite>
with 1.0’s (and then extracting only the original region of the result).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">cval</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="go">array([[13, 11,  8,  7],</span>
<span class="go">       [11,  3, 11, 14],</span>
<span class="go">       [16, 12, 14, 10],</span>
<span class="go">       [15,  6, 10,  5]])</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">mode='reflect'</span></code> (the default), outer values are reflected at the
edge of <cite>input</cite> to fill in missing values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
<span class="go">array([[5, 0, 0],</span>
<span class="go">       [3, 0, 0],</span>
<span class="go">       [1, 0, 0]])</span>
</pre></div>
</div>
<p>This includes diagonally at the corners.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="go">array([[4, 2, 0],</span>
<span class="go">       [3, 2, 0],</span>
<span class="go">       [1, 1, 0]])</span>
</pre></div>
</div>
<p>With <code class="docutils literal notranslate"><span class="pre">mode='nearest'</span></code>, the single nearest value in to an edge in
<cite>input</cite> is repeated as many times as needed to match the overlapping
<cite>weights</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="go">array([[7, 0, 3],</span>
<span class="go">       [5, 0, 2],</span>
<span class="go">       [3, 0, 1]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_convolve1d">
<code class="sig-name descname">sp_convolve1d</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_convolve1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional convolution along the given axis.</p>
<p>The lines of the array along the given axis are convolved with the
given weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – One-dimensional sequence of numbers.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>convolve1d</strong> – Convolved array with same shape as input</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">convolve1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convolve1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">array([14, 24,  4, 13, 12, 36, 27,  0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_correlate">
<code class="sig-name descname">sp_correlate</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_correlate" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional correlation.</p>
<p>The array is correlated with the given kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>weights</strong> (<em>ndarray</em>) – array of weights, same number of dimensions as input</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">convolve()</span></code></dt><dd><p>Convolve an image with a kernel.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_correlate1d">
<code class="sig-name descname">sp_correlate1d</code><span class="sig-paren">(</span><em class="sig-param">weights</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_correlate1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional correlation along the given axis.</p>
<p>The lines of the array along the given axis are correlated with the
given weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>weights</strong> (<em>array</em>) – One-dimensional sequence of numbers.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">correlate1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">correlate1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">array([ 8, 26,  8, 12,  7, 28, 36,  9])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_distance_transform_bf">
<code class="sig-name descname">sp_distance_transform_bf</code><span class="sig-paren">(</span><em class="sig-param">metric='euclidean'</em>, <em class="sig-param">sampling=None</em>, <em class="sig-param">return_distances=True</em>, <em class="sig-param">return_indices=False</em>, <em class="sig-param">distances=None</em>, <em class="sig-param">indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_distance_transform_bf" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance transform function by a brute force algorithm.</p>
<p>This function calculates the distance transform of the <cite>input</cite>, by
replacing each foreground (non-zero) element, with its
shortest distance to the background (any zero-valued element).</p>
<p>In addition to the distance transform, the feature transform can
be calculated. In this case the index of the closest background
element is returned along the first axis of the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input</p></li>
<li><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – Three types of distance metric are supported: ‘euclidean’, ‘taxicab’
and ‘chessboard’.</p></li>
<li><p><strong>sampling</strong> (<em>{int</em><em>, </em><em>sequence of ints}</em><em>, </em><em>optional</em>) – <p>This parameter is only used in the case of the euclidean <cite>metric</cite>
distance transform.</p>
<p>The sampling along each axis can be given by the <cite>sampling</cite> parameter
which should be a sequence of length equal to the input rank, or a
single number in which the <cite>sampling</cite> is assumed to be equal along all
axes.</p>
</p></li>
<li><p><strong>return_distances</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>The <cite>return_distances</cite> flag can be used to indicate if the distance
transform is returned.</p>
<p>The default is True.</p>
</p></li>
<li><p><strong>return_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – <p>The <cite>return_indices</cite> flags can be used to indicate if the feature
transform is returned.</p>
<p>The default is False.</p>
</p></li>
<li><p><strong>distances</strong> (<em>float64 ndarray</em><em>, </em><em>optional</em>) – Optional output array to hold distances (if <cite>return_distances</cite> is
True).</p></li>
<li><p><strong>indices</strong> (<em>int64 ndarray</em><em>, </em><em>optional</em>) – Optional output array to hold indices (if <cite>return_indices</cite> is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>distances</strong> (<em>ndarray</em>) – Distance array if <cite>return_distances</cite> is True.</p></li>
<li><p><strong>indices</strong> (<em>ndarray</em>) – Indices array if <cite>return_indices</cite> is True.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function employs a slow brute force algorithm, see also the
function distance_transform_cdt for more efficient taxicab and
chessboard algorithms.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_distance_transform_cdt">
<code class="sig-name descname">sp_distance_transform_cdt</code><span class="sig-paren">(</span><em class="sig-param">metric='chessboard'</em>, <em class="sig-param">return_distances=True</em>, <em class="sig-param">return_indices=False</em>, <em class="sig-param">distances=None</em>, <em class="sig-param">indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_distance_transform_cdt" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance transform for chamfer type of transforms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input</p></li>
<li><p><strong>metric</strong> (<em>{'chessboard'</em><em>, </em><em>'taxicab'}</em><em>, </em><em>optional</em>) – <p>The <cite>metric</cite> determines the type of chamfering that is done. If the
<cite>metric</cite> is equal to ‘taxicab’ a structure is generated using
generate_binary_structure with a squared distance equal to 1. If
the <cite>metric</cite> is equal to ‘chessboard’, a <cite>metric</cite> is generated
using generate_binary_structure with a squared distance equal to
the dimensionality of the array. These choices correspond to the
common interpretations of the ‘taxicab’ and the ‘chessboard’
distance metrics in two dimensions.</p>
<p>The default for <cite>metric</cite> is ‘chessboard’.</p>
</p></li>
<li><p><strong>return_indices</strong> (<em>return_distances</em><em>,</em>) – <p>The <cite>return_distances</cite>, and <cite>return_indices</cite> flags can be used to
indicate if the distance transform, the feature transform, or both
must be returned.</p>
<p>If the feature transform is returned (<code class="docutils literal notranslate"><span class="pre">return_indices=True</span></code>),
the index of the closest background element is returned along
the first axis of the result.</p>
<p>The <cite>return_distances</cite> default is True, and the
<cite>return_indices</cite> default is False.</p>
</p></li>
<li><p><strong>indices</strong> (<em>distances</em><em>,</em>) – The <cite>distances</cite> and <cite>indices</cite> arguments can be used to give optional
output arrays that must be the same shape as <cite>input</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_distance_transform_edt">
<code class="sig-name descname">sp_distance_transform_edt</code><span class="sig-paren">(</span><em class="sig-param">sampling=None</em>, <em class="sig-param">return_distances=True</em>, <em class="sig-param">return_indices=False</em>, <em class="sig-param">distances=None</em>, <em class="sig-param">indices=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_distance_transform_edt" title="Permalink to this definition">¶</a></dt>
<dd><p>Exact euclidean distance transform.</p>
<p>In addition to the distance transform, the feature transform can
be calculated. In this case the index of the closest background
element is returned along the first axis of the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input data to transform. Can be any type but will be converted
into binary: 1 wherever input equates to True, 0 elsewhere.</p></li>
<li><p><strong>sampling</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, or </em><em>sequence of same</em><em>, </em><em>optional</em>) – Spacing of elements along each dimension. If a sequence, must be of
length equal to the input rank; if a single number, this is used for
all axes. If not specified, a grid spacing of unity is implied.</p></li>
<li><p><strong>return_distances</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return distance matrix. At least one of
return_distances/return_indices must be True. Default is True.</p></li>
<li><p><strong>return_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to return indices matrix. Default is False.</p></li>
<li><p><strong>distances</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Used for output of distance array, must be of type float64.</p></li>
<li><p><strong>indices</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Used for output of indices, must be of type int32.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>distance_transform_edt</strong> – Either distance matrix, index matrix, or a list of the two,
depending on <cite>return_x</cite> flags and <cite>distance</cite> and <cite>indices</cite>
input parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray or list of ndarrays</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The euclidean distance transform gives values of the euclidean
distance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>              <span class="n">n</span>
<span class="n">y_i</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
              <span class="n">i</span>
</pre></div>
</div>
<p>where b[i] is the background point (value 0) with the smallest
Euclidean distance to input points x[i], and n is the
number of dimensions.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">distance_transform_edt</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">array([[ 0.    ,  1.    ,  1.4142,  2.2361,  3.    ],</span>
<span class="go">       [ 0.    ,  0.    ,  1.    ,  2.    ,  2.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.4142,  1.4142,  1.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.4142,  1.    ,  0.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])</span>
</pre></div>
</div>
<p>With a sampling of 2 units along x, 1 along y:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">distance_transform_edt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sampling</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">array([[ 0.    ,  1.    ,  2.    ,  2.8284,  3.6056],</span>
<span class="go">       [ 0.    ,  0.    ,  1.    ,  2.    ,  3.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  2.    ,  2.2361,  2.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  2.    ,  1.    ,  0.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])</span>
</pre></div>
</div>
<p>Asking for indices as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">edt</span><span class="p">,</span> <span class="n">inds</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">distance_transform_edt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inds</span>
<span class="go">array([[[0, 0, 1, 1, 3],</span>
<span class="go">        [1, 1, 1, 1, 3],</span>
<span class="go">        [2, 2, 1, 3, 3],</span>
<span class="go">        [3, 3, 4, 4, 3],</span>
<span class="go">        [4, 4, 4, 4, 4]],</span>
<span class="go">       [[0, 0, 1, 1, 4],</span>
<span class="go">        [0, 1, 1, 1, 4],</span>
<span class="go">        [0, 0, 1, 4, 4],</span>
<span class="go">        [0, 0, 3, 3, 4],</span>
<span class="go">        [0, 0, 3, 3, 4]]])</span>
</pre></div>
</div>
<p>With arrays provided for inplace outputs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">a</span><span class="p">),)</span> <span class="o">+</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">distance_transform_edt</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">return_indices</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
<span class="go">array([[ 0.    ,  1.    ,  1.4142,  2.2361,  3.    ],</span>
<span class="go">       [ 0.    ,  0.    ,  1.    ,  2.    ,  2.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.4142,  1.4142,  1.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.4142,  1.    ,  0.    ],</span>
<span class="go">       [ 0.    ,  1.    ,  1.    ,  0.    ,  0.    ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">indices</span>
<span class="go">array([[[0, 0, 1, 1, 3],</span>
<span class="go">        [1, 1, 1, 1, 3],</span>
<span class="go">        [2, 2, 1, 3, 3],</span>
<span class="go">        [3, 3, 4, 4, 3],</span>
<span class="go">        [4, 4, 4, 4, 4]],</span>
<span class="go">       [[0, 0, 1, 1, 4],</span>
<span class="go">        [0, 1, 1, 1, 4],</span>
<span class="go">        [0, 0, 1, 4, 4],</span>
<span class="go">        [0, 0, 3, 3, 4],</span>
<span class="go">        [0, 0, 3, 3, 4]]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_extrema">
<code class="sig-name descname">sp_extrema</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_extrema" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the minimums and maximums of the values of an array
at labels, along with their positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>ndarray</em>) – Nd-image data to process.</p></li>
<li><p><strong>labels</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – Labels of features in input.
If not None, must be same shape as <cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – Labels to include in output.  If None (default), all values where
non-zero <cite>labels</cite> are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>minimums, maximums</strong> (<em>int or ndarray</em>) – Values of minimums and maximums in each feature.</p></li>
<li><p><strong>min_positions, max_positions</strong> (<em>tuple or list of tuples</em>) – Each tuple gives the n-D coordinates of the corresponding minimum
or maximum.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum_position()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum_position()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">center_of_mass()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">extrema</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(0, 9, (0, 2), (3, 0))</span>
</pre></div>
</div>
<p>Features to process can be specified using <cite>labels</cite> and <cite>index</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbl</span><span class="p">,</span> <span class="n">nlbl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">extrema</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlbl</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">(array([1, 4, 3]),</span>
<span class="go"> array([5, 7, 9]),</span>
<span class="go"> [(0, 0), (1, 3), (3, 1)],</span>
<span class="go"> [(1, 0), (2, 3), (3, 0)])</span>
</pre></div>
</div>
<p>If no index is given, non-zero <cite>labels</cite> are processed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">extrema</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>
<span class="go">(1, 9, (0, 0), (3, 0))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_find_objects">
<code class="sig-name descname">sp_find_objects</code><span class="sig-paren">(</span><em class="sig-param">max_label=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_find_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Find objects in a labeled array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>ndarray of ints</em>) – Array containing objects defined by different labels. Labels with
value 0 are ignored.</p></li>
<li><p><strong>max_label</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum label to be searched for in <cite>input</cite>. If max_label is not
given, the positions of all objects are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>object_slices</strong> – A list of tuples, with each tuple containing N slices (with N the
dimension of the input array).  Slices correspond to the minimal
parallelepiped that contains the object. If a number is missing,
None is returned instead of a slice.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">center_of_mass()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>This function is very useful for isolating a volume of interest inside
a 3-D array, that cannot be “seen through”.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[:</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[2, 2, 2, 0, 0, 3],</span>
<span class="go">       [2, 2, 2, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">[(slice(2, 5, None), slice(2, 5, None)), (slice(0, 2, None), slice(0, 3, None)), (slice(0, 1, None), slice(5, 6, None))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">max_label</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(slice(2, 5, None), slice(2, 5, None)), (slice(0, 2, None), slice(0, 3, None))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">a</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_label</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">[(slice(2, 5, None), slice(2, 5, None)), None]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">find_objects</span><span class="p">(</span><span class="n">a</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="n">loc</span><span class="p">]</span>
<span class="go">array([[1, 1, 0],</span>
<span class="go">       [1, 1, 0],</span>
<span class="go">       [0, 0, 1]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_fourier_ellipsoid">
<code class="sig-name descname">sp_fourier_ellipsoid</code><span class="sig-paren">(</span><em class="sig-param">size</em>, <em class="sig-param">n=-1</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_fourier_ellipsoid" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional ellipsoid fourier filter.</p>
<p>The array is multiplied with the fourier transform of a ellipsoid of
given sizes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em>) – The size of the box used for filtering.
If a float, <cite>size</cite> is the same for all axes. If a sequence, <cite>size</cite> has
to contain one value for each axis.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – If <cite>n</cite> is negative (default), then the input is assumed to be the
result of a complex fft.
If <cite>n</cite> is larger than or equal to zero, the input is assumed to be the
result of a real fft, and <cite>n</cite> gives the length of the array before
transformation along the real transform direction.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of the real transform.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – If given, the result of filtering the input is placed in this array.
None is returned in this case.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fourier_ellipsoid</strong> – The filtered input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function is implemented for arrays of rank 1, 2, or 3.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_ellipsoid</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>  <span class="c1"># the imaginary part is an artifact</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_fourier_gaussian">
<code class="sig-name descname">sp_fourier_gaussian</code><span class="sig-paren">(</span><em class="sig-param">sigma</em>, <em class="sig-param">n=-1</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_fourier_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional Gaussian fourier filter.</p>
<p>The array is multiplied with the fourier transform of a Gaussian
kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>sigma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em>) – The sigma of the Gaussian kernel. If a float, <cite>sigma</cite> is the same for
all axes. If a sequence, <cite>sigma</cite> has to contain one value for each
axis.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – If <cite>n</cite> is negative (default), then the input is assumed to be the
result of a complex fft.
If <cite>n</cite> is larger than or equal to zero, the input is assumed to be the
result of a real fft, and <cite>n</cite> gives the length of the array before
transformation along the real transform direction.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of the real transform.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – If given, the result of filtering the input is placed in this array.
None is returned in this case.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fourier_gaussian</strong> – The filtered input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_gaussian</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>  <span class="c1"># the imaginary part is an artifact</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_fourier_shift">
<code class="sig-name descname">sp_fourier_shift</code><span class="sig-paren">(</span><em class="sig-param">shift</em>, <em class="sig-param">n=-1</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_fourier_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional fourier shift filter.</p>
<p>The array is multiplied with the fourier transform of a shift operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em>) – The size of the box used for filtering.
If a float, <cite>shift</cite> is the same for all axes. If a sequence, <cite>shift</cite>
has to contain one value for each axis.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – If <cite>n</cite> is negative (default), then the input is assumed to be the
result of a complex fft.
If <cite>n</cite> is larger than or equal to zero, the input is assumed to be the
result of a real fft, and <cite>n</cite> gives the length of the array before
transformation along the real transform direction.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of the real transform.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – If given, the result of shifting the input is placed in this array.
None is returned in this case.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fourier_shift</strong> – The shifted input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_shift</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">shift</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>  <span class="c1"># the imaginary part is an artifact</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_fourier_uniform">
<code class="sig-name descname">sp_fourier_uniform</code><span class="sig-paren">(</span><em class="sig-param">size</em>, <em class="sig-param">n=-1</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_fourier_uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional uniform fourier filter.</p>
<p>The array is multiplied with the fourier transform of a box of given
size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em>) – The size of the box used for filtering.
If a float, <cite>size</cite> is the same for all axes. If a sequence, <cite>size</cite> has
to contain one value for each axis.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – If <cite>n</cite> is negative (default), then the input is assumed to be the
result of a complex fft.
If <cite>n</cite> is larger than or equal to zero, the input is assumed to be the
result of a real fft, and <cite>n</cite> gives the length of the array before
transformation along the real transform direction.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of the real transform.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – If given, the result of filtering the input is placed in this array.
None is returned in this case.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fourier_uniform</strong> – The filtered input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy.fft</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft2</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">fourier_uniform</span><span class="p">(</span><span class="n">input_</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft2</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">real</span><span class="p">)</span>  <span class="c1"># the imaginary part is an artifact</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_gaussian_filter">
<code class="sig-name descname">sp_gaussian_filter</code><span class="sig-paren">(</span><em class="sig-param">sigma</em>, <em class="sig-param">order=0</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">truncate=4.0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_gaussian_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Multidimensional Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>sigma</strong> (<em>scalar</em><em> or </em><em>sequence of scalars</em>) – Standard deviation for Gaussian kernel. The standard
deviations of the Gaussian filter are given for each axis as a
sequence, or as a single number, in which case it is equal for
all axes.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – The order of the filter along each axis is given as a sequence
of integers, or as a single number.  An order of 0 corresponds
to convolution with a Gaussian kernel. A positive order
corresponds to convolution with that derivative of a Gaussian.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Truncate the filter at this many standard deviations.
Default is 4.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gaussian_filter</strong> – Returned array of same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The multidimensional filter is implemented as a sequence of
one-dimensional convolution filters. The intermediate arrays are
stored in the same data type as the output. Therefore, for output
types with a limited precision, the results may be imprecise
because intermediate results may be stored with insufficient
precision.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">gaussian_filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[ 0,  2,  4,  6,  8],</span>
<span class="go">       [10, 12, 14, 16, 18],</span>
<span class="go">       [20, 22, 24, 26, 28],</span>
<span class="go">       [30, 32, 34, 36, 38],</span>
<span class="go">       [40, 42, 44, 46, 48]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([[ 4,  6,  8,  9, 11],</span>
<span class="go">       [10, 12, 14, 15, 17],</span>
<span class="go">       [20, 22, 24, 25, 27],</span>
<span class="go">       [29, 31, 33, 34, 36],</span>
<span class="go">       [35, 37, 39, 40, 42]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">gaussian_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_gaussian_filter1d">
<code class="sig-name descname">sp_gaussian_filter1d</code><span class="sig-paren">(</span><em class="sig-param">sigma</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">order=0</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">truncate=4.0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_gaussian_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>One-dimensional Gaussian filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>sigma</strong> (<em>scalar</em>) – standard deviation for Gaussian kernel</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – An order of 0 corresponds to convolution with a Gaussian
kernel. A positive order corresponds to convolution with
that derivative of a Gaussian.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>truncate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – Truncate the filter at this many standard deviations.
Default is 4.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gaussian_filter1d</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">gaussian_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 1.42704095,  2.06782203,  3.        ,  3.93217797,  4.57295905])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gaussian_filter1d</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="mi">4</span><span class="p">)</span>
<span class="go">array([ 2.91948343,  2.95023502,  3.        ,  3.04976498,  3.08051657])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">280490</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">101</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y3</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y6</span> <span class="o">=</span> <span class="n">gaussian_filter1d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;original data&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y3</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y6</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;filtered, sigma=6&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_gaussian_gradient_magnitude">
<code class="sig-name descname">sp_gaussian_gradient_magnitude</code><span class="sig-paren">(</span><em class="sig-param">sigma</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_gaussian_gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Multidimensional gradient magnitude using Gaussian derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>sigma</strong> (<em>scalar</em><em> or </em><em>sequence of scalars</em>) – The standard deviations of the Gaussian filter are given for
each axis as a sequence, or as a single number, in which case
it is equal for all axes..</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>keyword arguments will be passed to gaussian_filter</strong><strong>(</strong><strong>)</strong><strong></strong> (<em>Extra</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>gaussian_gradient_magnitude</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_gradient_magnitude</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_gaussian_laplace">
<code class="sig-name descname">sp_gaussian_laplace</code><span class="sig-paren">(</span><em class="sig-param">sigma</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_gaussian_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Multidimensional Laplace filter using gaussian second derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>sigma</strong> (<em>scalar</em><em> or </em><em>sequence of scalars</em>) – The standard deviations of the Gaussian filter are given for
each axis as a sequence, or as a single number, in which case
it is equal for all axes.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>keyword arguments will be passed to gaussian_filter</strong><strong>(</strong><strong>)</strong><strong></strong> (<em>Extra</em>) – </p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_laplace</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">gaussian_laplace</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_generic_filter">
<code class="sig-name descname">sp_generic_filter</code><span class="sig-paren">(</span><em class="sig-param">function</em>, <em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em>, <em class="sig-param">extra_arguments=()</em>, <em class="sig-param">extra_keywords=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_generic_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multi-dimensional filter using the given function.</p>
<p>At each element the provided function is called. The input values
within the filter footprint at that element are passed to the function
as a 1D array of double values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>function</strong> (<em>{callable</em><em>, </em><em>scipy.LowLevelCallable}</em>) – Function to apply at each element.</p></li>
<li><p><strong>size</strong> (<em>scalar</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – See footprint, below. Ignored if footprint is given.</p></li>
<li><p><strong>footprint</strong> (<em>array</em><em>, </em><em>optional</em>) – Either <cite>size</cite> or <cite>footprint</cite> must be defined.  <cite>size</cite> gives
the shape that is taken from the input array, at every element
position, to define the input to the filter function.
<cite>footprint</cite> is a boolean array that specifies (implicitly) a
shape, but also which of the elements within this shape will get
passed to the filter function.  Thus <code class="docutils literal notranslate"><span class="pre">size=(n,m)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">footprint=np.ones((n,m))</span></code>.  We adjust <cite>size</cite> to the number
of dimensions of the input array, so that, if the input array is
shape (10,10,10), and <cite>size</cite> is 2, then the actual size used is
(2,2,2). When <cite>footprint</cite> is given, <cite>size</cite> is ignored.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
<li><p><strong>extra_arguments</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Sequence of extra positional arguments to pass to passed function.</p></li>
<li><p><strong>extra_keywords</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em>, </em><em>optional</em>) – dict of extra keyword arguments to pass to passed function.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function also accepts low-level callback functions with one of
the following signatures and wrapped in <cite>scipy.LowLevelCallable</cite>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">callback</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="n">npy_intp</span> <span class="n">filter_size</span><span class="p">,</span>
             <span class="kt">double</span> <span class="o">*</span><span class="n">return_value</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">user_data</span><span class="p">)</span>
<span class="kt">int</span> <span class="n">callback</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">buffer</span><span class="p">,</span> <span class="kt">intptr_t</span> <span class="n">filter_size</span><span class="p">,</span>
             <span class="kt">double</span> <span class="o">*</span><span class="n">return_value</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">user_data</span><span class="p">)</span>
</pre></div>
</div>
<p>The calling function iterates over the elements of the input and
output arrays, calling the callback function at each element. The
elements within the footprint of the filter at the current element are
passed through the <code class="docutils literal notranslate"><span class="pre">buffer</span></code> parameter, and the number of elements
within the footprint through <code class="docutils literal notranslate"><span class="pre">filter_size</span></code>. The calculated value is
returned in <code class="docutils literal notranslate"><span class="pre">return_value</span></code>. <code class="docutils literal notranslate"><span class="pre">user_data</span></code> is the data pointer provided
to <cite>scipy.LowLevelCallable</cite> as-is.</p>
<p>The callback function must return an integer error status that is zero
if something went wrong and one otherwise. If an error occurs, you should
normally set the python error status with an informative message
before returning, otherwise a default error message is set by the
calling function.</p>
<p>In addition, some other low-level function pointer specifications
are accepted, but these are for backward compatibility only and should
not be used in new code.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_generic_filter1d">
<code class="sig-name descname">sp_generic_filter1d</code><span class="sig-paren">(</span><em class="sig-param">function</em>, <em class="sig-param">filter_size</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em>, <em class="sig-param">extra_arguments=()</em>, <em class="sig-param">extra_keywords=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_generic_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional filter along the given axis.</p>
<p><cite>generic_filter1d</cite> iterates over the lines of the array, calling the
given function at each line. The arguments of the line are the
input line, and the output line. The input and output lines are 1D
double arrays.  The input line is extended appropriately according
to the filter size and origin. The output line must be modified
in-place with the result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>function</strong> (<em>{callable</em><em>, </em><em>scipy.LowLevelCallable}</em>) – Function to apply along given axis.</p></li>
<li><p><strong>filter_size</strong> (<em>scalar</em>) – Length of the filter.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right.</p></li>
<li><p><strong>extra_arguments</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Sequence of extra positional arguments to pass to passed function.</p></li>
<li><p><strong>extra_keywords</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em>, </em><em>optional</em>) – dict of extra keyword arguments to pass to passed function.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function also accepts low-level callback functions with one of
the following signatures and wrapped in <cite>scipy.LowLevelCallable</cite>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">function</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">input_line</span><span class="p">,</span> <span class="n">npy_intp</span> <span class="n">input_length</span><span class="p">,</span>
             <span class="kt">double</span> <span class="o">*</span><span class="n">output_line</span><span class="p">,</span> <span class="n">npy_intp</span> <span class="n">output_length</span><span class="p">,</span>
             <span class="kt">void</span> <span class="o">*</span><span class="n">user_data</span><span class="p">)</span>
<span class="kt">int</span> <span class="n">function</span><span class="p">(</span><span class="kt">double</span> <span class="o">*</span><span class="n">input_line</span><span class="p">,</span> <span class="kt">intptr_t</span> <span class="n">input_length</span><span class="p">,</span>
             <span class="kt">double</span> <span class="o">*</span><span class="n">output_line</span><span class="p">,</span> <span class="kt">intptr_t</span> <span class="n">output_length</span><span class="p">,</span>
             <span class="kt">void</span> <span class="o">*</span><span class="n">user_data</span><span class="p">)</span>
</pre></div>
</div>
<p>The calling function iterates over the lines of the input and output
arrays, calling the callback function at each line. The current line
is extended according to the border conditions set by the calling
function, and the result is copied into the array that is passed
through <code class="docutils literal notranslate"><span class="pre">input_line</span></code>. The length of the input line (after extension)
is passed through <code class="docutils literal notranslate"><span class="pre">input_length</span></code>. The callback function should apply
the filter and store the result in the array passed through
<code class="docutils literal notranslate"><span class="pre">output_line</span></code>. The length of the output line is passed through
<code class="docutils literal notranslate"><span class="pre">output_length</span></code>. <code class="docutils literal notranslate"><span class="pre">user_data</span></code> is the data pointer provided
to <cite>scipy.LowLevelCallable</cite> as-is.</p>
<p>The callback function must return an integer error status that is zero
if something went wrong and one otherwise. If an error occurs, you should
normally set the python error status with an informative message
before returning, otherwise a default error message is set by the
calling function.</p>
<p>In addition, some other low-level function pointer specifications
are accepted, but these are for backward compatibility only and should
not be used in new code.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_generic_gradient_magnitude">
<code class="sig-name descname">sp_generic_gradient_magnitude</code><span class="sig-paren">(</span><em class="sig-param">derivative</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">extra_arguments=()</em>, <em class="sig-param">extra_keywords=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_generic_gradient_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Gradient magnitude using a provided gradient function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>derivative</strong> (<em>callable</em>) – <p>Callable with the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">derivative</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">cval</span><span class="p">,</span>
           <span class="o">*</span><span class="n">extra_arguments</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_keywords</span><span class="p">)</span>
</pre></div>
</div>
<p>See <cite>extra_arguments</cite>, <cite>extra_keywords</cite> below.
<cite>derivative</cite> can assume that <cite>input</cite> and <cite>output</cite> are ndarrays.
Note that the output from <cite>derivative</cite> is modified inplace;
be careful to copy important inputs before returning them.</p>
</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>extra_keywords</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em>, </em><em>optional</em>) – dict of extra keyword arguments to pass to passed function.</p></li>
<li><p><strong>extra_arguments</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Sequence of extra positional arguments to pass to passed function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_generic_laplace">
<code class="sig-name descname">sp_generic_laplace</code><span class="sig-paren">(</span><em class="sig-param">derivative2</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">extra_arguments=()</em>, <em class="sig-param">extra_keywords=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_generic_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>N-dimensional Laplace filter using a provided second derivative function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>derivative2</strong> (<em>callable</em>) – <p>Callable with the following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">derivative2</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">output</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">cval</span><span class="p">,</span>
            <span class="o">*</span><span class="n">extra_arguments</span><span class="p">,</span> <span class="o">**</span><span class="n">extra_keywords</span><span class="p">)</span>
</pre></div>
</div>
<p>See <cite>extra_arguments</cite>, <cite>extra_keywords</cite> below.</p>
</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>extra_keywords</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em>, </em><em>optional</em>) – dict of extra keyword arguments to pass to passed function.</p></li>
<li><p><strong>extra_arguments</strong> (<em>sequence</em><em>, </em><em>optional</em>) – Sequence of extra positional arguments to pass to passed function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_geometric_transform">
<code class="sig-name descname">sp_geometric_transform</code><span class="sig-paren">(</span><em class="sig-param">mapping</em>, <em class="sig-param">output_shape=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">order=3</em>, <em class="sig-param">mode='constant'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">prefilter=True</em>, <em class="sig-param">extra_arguments=()</em>, <em class="sig-param">extra_keywords={}</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_geometric_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an arbitrary geometric transform.</p>
<p>The given mapping function is used to find, for each point in the
output, the corresponding coordinates in the input. The value of the
input at those coordinates is determined by spline interpolation of
the requested order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>mapping</strong> (<em>{callable</em><em>, </em><em>scipy.LowLevelCallable}</em>) – A callable object that accepts a tuple of length equal to the output
array rank, and returns the corresponding input coordinates as a tuple
of length equal to the input array rank.</p></li>
<li><p><strong>output_shape</strong> (<em>tuple of ints</em><em>, </em><em>optional</em>) – Shape tuple.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline interpolation, default is 3.
The order has to be in the range 0-5.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>prefilter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the input array is prefiltered with <cite>spline_filter</cite>
before interpolation. The default is True, which will create a
temporary <cite>float64</cite> array of filtered values if <cite>order &gt; 1</cite>. If
setting this to False, the output will be slightly blurred if
<cite>order &gt; 1</cite>, unless the input is prefiltered, i.e. it is the result
of calling <cite>spline_filter</cite> on the original input.</p></li>
<li><p><strong>extra_arguments</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – Extra arguments passed to <cite>mapping</cite>.</p></li>
<li><p><strong>extra_keywords</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em>, </em><em>optional</em>) – Extra keywords passed to <cite>mapping</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – The filtered input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">map_coordinates()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">affine_transform()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">spline_filter1d()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>This function also accepts low-level callback functions with one
the following signatures and wrapped in <cite>scipy.LowLevelCallable</cite>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">mapping</span><span class="p">(</span><span class="n">npy_intp</span> <span class="o">*</span><span class="n">output_coordinates</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">input_coordinates</span><span class="p">,</span>
            <span class="kt">int</span> <span class="n">output_rank</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input_rank</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">user_data</span><span class="p">)</span>
<span class="kt">int</span> <span class="n">mapping</span><span class="p">(</span><span class="kt">intptr_t</span> <span class="o">*</span><span class="n">output_coordinates</span><span class="p">,</span> <span class="kt">double</span> <span class="o">*</span><span class="n">input_coordinates</span><span class="p">,</span>
            <span class="kt">int</span> <span class="n">output_rank</span><span class="p">,</span> <span class="kt">int</span> <span class="n">input_rank</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">user_data</span><span class="p">)</span>
</pre></div>
</div>
<p>The calling function iterates over the elements of the output array,
calling the callback function at each element. The coordinates of the
current output element are passed through <code class="docutils literal notranslate"><span class="pre">output_coordinates</span></code>. The
callback function must return the coordinates at which the input must
be interpolated in <code class="docutils literal notranslate"><span class="pre">input_coordinates</span></code>. The rank of the input and
output arrays are given by <code class="docutils literal notranslate"><span class="pre">input_rank</span></code> and <code class="docutils literal notranslate"><span class="pre">output_rank</span></code>
respectively.  <code class="docutils literal notranslate"><span class="pre">user_data</span></code> is the data pointer provided
to <cite>scipy.LowLevelCallable</cite> as-is.</p>
<p>The callback function must return an integer error status that is zero
if something went wrong and one otherwise. If an error occurs, you should
normally set the python error status with an informative message
before returning, otherwise a default error message is set by the
calling function.</p>
<p>In addition, some other low-level function pointer specifications
are accepted, but these are for backward compatibility only and should
not be used in new code.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">geometric_transform</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">shift_func</span><span class="p">(</span><span class="n">output_coords</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">output_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">output_coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometric_transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">shift_func</span><span class="p">)</span>
<span class="go">array([[ 0.   ,  0.   ,  0.   ],</span>
<span class="go">       [ 0.   ,  1.362,  2.738],</span>
<span class="go">       [ 0.   ,  4.812,  6.187],</span>
<span class="go">       [ 0.   ,  8.263,  9.637]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">shift_func</span><span class="p">(</span><span class="n">output_coords</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">output_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometric_transform</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">shift_func</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<span class="go">array([0, 0, 0, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometric_transform</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">shift_func</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="go">array([1, 1, 1, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometric_transform</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">shift_func</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
<span class="go">array([3, 2, 1, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">geometric_transform</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">shift_func</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;wrap&#39;</span><span class="p">)</span>
<span class="go">array([2, 3, 4, 1, 2])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_grey_closing">
<code class="sig-name descname">sp_grey_closing</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_grey_closing" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional greyscale closing.</p>
<p>A greyscale closing consists in the succession of a greyscale dilation,
and a greyscale erosion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array over which the grayscale closing is to be computed.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em>) – Shape of a flat and full structuring element used for the grayscale
closing. Optional if <cite>footprint</cite> or <cite>structure</cite> is provided.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of non-infinite elements of a flat structuring element
used for the grayscale closing.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the grayscale closing. <cite>structure</cite>
may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the closing may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grey_closing</strong> – Result of the grayscale closing of <cite>input</cite> with <cite>structure</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The action of a grayscale closing with a flat structuring element amounts
to smoothen deep local minima, whereas binary closing fills small holes.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id32"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5],</span>
<span class="go">       [ 6,  7,  8,  9, 10, 11],</span>
<span class="go">       [12, 13, 14, 15, 16, 17],</span>
<span class="go">       [18, 19, 20,  0, 22, 23],</span>
<span class="go">       [24, 25, 26, 27, 28, 29],</span>
<span class="go">       [30, 31, 32, 33, 34, 35]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_closing</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[ 7,  7,  8,  9, 10, 11],</span>
<span class="go">       [ 7,  7,  8,  9, 10, 11],</span>
<span class="go">       [13, 13, 14, 15, 16, 17],</span>
<span class="go">       [19, 19, 20, 20, 22, 23],</span>
<span class="go">       [25, 25, 26, 27, 28, 29],</span>
<span class="go">       [31, 31, 32, 33, 34, 35]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that the local minimum a[3,3] has disappeared</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_grey_dilation">
<code class="sig-name descname">sp_grey_dilation</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_grey_dilation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a greyscale dilation, using either a structuring element,
or a footprint corresponding to a flat structuring element.</p>
<p>Grayscale dilation is a mathematical morphology operation. For the
simple case of a full and flat structuring element, it can be viewed
as a maximum filter over a sliding window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array over which the grayscale dilation is to be computed.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em>) – Shape of a flat and full structuring element used for the grayscale
dilation. Optional if <cite>footprint</cite> or <cite>structure</cite> is provided.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of non-infinite elements of a flat structuring element
used for the grayscale dilation. Non-zero values give the set of
neighbors of the center over which the maximum is chosen.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the grayscale dilation. <cite>structure</cite>
may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the dilation may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>,</em><em>'constant'</em><em>,</em><em>'nearest'</em><em>,</em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grey_dilation</strong> – Grayscale dilation of <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.maximum_filter()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The grayscale dilation of an image input by a structuring element s defined
over a domain E is given by:</p>
<p>(input+s)(x) = max {input(y) + s(x-y), for y in E}</p>
<p>In particular, for structuring elements defined as
s(y) = 0 for y in E, the grayscale dilation computes the maximum of the
input image inside a sliding window defined by E.</p>
<p>Grayscale dilation <a href="#id65"><span class="problematic" id="id33">[1]_</span></a> is a <em>mathematical morphology</em> operation <a href="#id66"><span class="problematic" id="id34">[2]_</span></a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id35"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Dilation_%28morphology%29">https://en.wikipedia.org/wiki/Dilation_%28morphology%29</a></p>
</dd>
<dt class="label" id="id36"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 3, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 2, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 2, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">footprint</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 2, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span>
<span class="go">array([[False,  True, False],</span>
<span class="go">       [ True,  True,  True],</span>
<span class="go">       [False,  True, False]], dtype=bool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">footprint</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 3, 1, 0, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 1, 3, 2, 1, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 0, 1, 1, 2, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">array([[1, 1, 1, 1, 1, 1, 1],</span>
<span class="go">       [1, 2, 4, 4, 4, 2, 1],</span>
<span class="go">       [1, 2, 4, 4, 4, 2, 1],</span>
<span class="go">       [1, 2, 4, 4, 4, 3, 1],</span>
<span class="go">       [1, 2, 2, 3, 3, 3, 1],</span>
<span class="go">       [1, 2, 2, 3, 3, 3, 1],</span>
<span class="go">       [1, 1, 1, 1, 1, 1, 1]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_grey_erosion">
<code class="sig-name descname">sp_grey_erosion</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_grey_erosion" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a greyscale erosion, using either a structuring element,
or a footprint corresponding to a flat structuring element.</p>
<p>Grayscale erosion is a mathematical morphology operation. For the
simple case of a full and flat structuring element, it can be viewed
as a minimum filter over a sliding window.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array over which the grayscale erosion is to be computed.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em>) – Shape of a flat and full structuring element used for the grayscale
erosion. Optional if <cite>footprint</cite> or <cite>structure</cite> is provided.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of non-infinite elements of a flat structuring element
used for the grayscale erosion. Non-zero values give the set of
neighbors of the center over which the minimum is chosen.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the grayscale erosion. <cite>structure</cite>
may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the erosion may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>,</em><em>'constant'</em><em>,</em><em>'nearest'</em><em>,</em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – Grayscale erosion of <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.minimum_filter()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The grayscale erosion of an image input by a structuring element s defined
over a domain E is given by:</p>
<p>(input+s)(x) = min {input(y) - s(x-y), for y in E}</p>
<p>In particular, for structuring elements defined as
s(y) = 0 for y in E, the grayscale erosion computes the minimum of the
input image inside a sliding window defined by E.</p>
<p>Grayscale erosion <a href="#id67"><span class="problematic" id="id37">[1]_</span></a> is a <em>mathematical morphology</em> operation <a href="#id68"><span class="problematic" id="id38">[2]_</span></a>.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id39"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Erosion_%28morphology%29">https://en.wikipedia.org/wiki/Erosion_%28morphology%29</a></p>
</dd>
<dt class="label" id="id40"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<span class="go">       [0, 3, 3, 1, 3, 3, 0],</span>
<span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<span class="go">       [0, 3, 3, 3, 2, 3, 0],</span>
<span class="go">       [0, 3, 3, 3, 3, 3, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 3, 2, 2, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">footprint</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">footprint</span>
<span class="go">array([[False,  True, False],</span>
<span class="go">       [ True,  True,  True],</span>
<span class="go">       [False,  True, False]], dtype=bool)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Diagonally-connected elements are not considered neighbors</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">footprint</span><span class="o">=</span><span class="n">footprint</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 3, 1, 2, 0, 0],</span>
<span class="go">       [0, 0, 3, 2, 2, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_grey_opening">
<code class="sig-name descname">sp_grey_opening</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_grey_opening" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional greyscale opening.</p>
<p>A greyscale opening consists in the succession of a greyscale erosion,
and a greyscale dilation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array over which the grayscale opening is to be computed.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em>) – Shape of a flat and full structuring element used for the grayscale
opening. Optional if <cite>footprint</cite> or <cite>structure</cite> is provided.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of non-infinite elements of a flat structuring element
used for the grayscale opening.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the grayscale opening. <cite>structure</cite>
may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the opening may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>grey_opening</strong> – Result of the grayscale opening of <cite>input</cite> with <cite>structure</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">binary_opening()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_closing()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">generate_binary_structure()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The action of a grayscale opening with a flat structuring element amounts
to smoothen high local maxima, whereas binary opening erases small objects.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id41"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  5],</span>
<span class="go">       [ 6,  7,  8,  9, 10, 11],</span>
<span class="go">       [12, 13, 14, 15, 16, 17],</span>
<span class="go">       [18, 19, 20, 50, 22, 23],</span>
<span class="go">       [24, 25, 26, 27, 28, 29],</span>
<span class="go">       [30, 31, 32, 33, 34, 35]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_opening</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[ 0,  1,  2,  3,  4,  4],</span>
<span class="go">       [ 6,  7,  8,  9, 10, 10],</span>
<span class="go">       [12, 13, 14, 15, 16, 16],</span>
<span class="go">       [18, 19, 20, 22, 22, 22],</span>
<span class="go">       [24, 25, 26, 27, 28, 28],</span>
<span class="go">       [24, 25, 26, 27, 28, 28]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Note that the local maximum a[3,3] has disappeared</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_histogram">
<code class="sig-name descname">sp_histogram</code><span class="sig-paren">(</span><em class="sig-param">min</em>, <em class="sig-param">max</em>, <em class="sig-param">bins</em>, <em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_histogram" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the histogram of the values of an array, optionally at labels.</p>
<p>Histogram calculates the frequency of values in an array within bins
determined by <cite>min</cite>, <cite>max</cite>, and <cite>bins</cite>. The <cite>labels</cite> and <cite>index</cite>
keywords can limit the scope of the histogram to specified sub-regions
within the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Data for which to calculate histogram.</p></li>
<li><p><strong>max</strong> (<em>min</em><em>,</em>) – Minimum and maximum values of range of histogram bins.</p></li>
<li><p><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of bins.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Labels for objects in <cite>input</cite>.
If not None, must be same shape as <cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – Label or labels for which to calculate histogram. If None, all values
where label is greater than zero are used</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hist</strong> – Histogram counts.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.2146</span><span class="p">,</span>  <span class="mf">0.5962</span><span class="p">,</span>  <span class="mf">0.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.7778</span><span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.7181</span><span class="p">,</span>  <span class="mf">0.2787</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span> <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.</span>    <span class="p">,</span>  <span class="mf">0.6573</span><span class="p">,</span>  <span class="mf">0.3094</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">array([13,  0,  2,  1,  0,  1,  1,  2,  0,  0])</span>
</pre></div>
</div>
<p>With labels and no indices, non-zero elements are counted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbl</span><span class="p">,</span> <span class="n">nlbl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>
<span class="go">array([0, 0, 2, 1, 0, 1, 1, 2, 0, 0])</span>
</pre></div>
</div>
<p>Indices can be used to count only certain objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">measurements</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([0, 0, 1, 1, 0, 0, 1, 1, 0, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_label">
<code class="sig-name descname">sp_label</code><span class="sig-paren">(</span><em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Label features in an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – An array-like object to be labeled.  Any non-zero values in <cite>input</cite> are
counted as features and zero values are considered the background.</p></li>
<li><p><strong>structure</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A structuring element that defines feature connections.
<cite>structure</cite> must be symmetric.  If no structuring element is provided,
one is automatically generated with a squared connectivity equal to
one.  That is, for a 2-D <cite>input</cite> array, the default structuring element
is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</p></li>
<li><p><strong>output</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a><em>, </em><em>data-type</em><em>, </em><em>array_like</em><em>)</em><em>, </em><em>optional</em>) – If <cite>output</cite> is a data type, it specifies the type of the resulting
labeled feature array
If <cite>output</cite> is an array-like object, then <cite>output</cite> will be updated
with the labeled features from this function.  This function can
operate in-place, by passing output=input.
Note that the output must be able to store the largest label, or this
function will raise an Exception.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>label</strong> (<em>ndarray or int</em>) – An integer ndarray where each unique feature in <cite>input</cite> has a unique
label in the returned array.</p></li>
<li><p><strong>num_features</strong> (<em>int</em>) – How many objects were found.</p>
<p>If <cite>output</cite> is None, this function returns a tuple of
(<cite>labeled_array</cite>, <cite>num_features</cite>).</p>
<p>If <cite>output</cite> is a ndarray, then it will be updated with values in
<cite>labeled_array</cite> and only <cite>num_features</cite> will be returned by this
function.</p>
</li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">find_objects()</span></code></dt><dd><p>generate a list of slices for the labeled features (or objects); useful for finding features’ position or dimensions</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<p>Create an image with some features, then label it using the default
(cross-shaped) structuring element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">label</span><span class="p">,</span> <span class="n">generate_binary_structure</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_array</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<p>Each of the 4 features are labeled with a different integer:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_features</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_array</span>
<span class="go">array([[0, 0, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0],</span>
<span class="go">       [2, 2, 0, 0, 3, 0],</span>
<span class="go">       [0, 0, 0, 4, 0, 0]])</span>
</pre></div>
</div>
<p>Generate a structuring element that will consider features connected even
if they touch diagonally:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">generate_binary_structure</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>or,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>     <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
<p>Label the image using the new structuring element:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_array</span><span class="p">,</span> <span class="n">num_features</span> <span class="o">=</span> <span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>Show the 2 labeled features (note that features 1, 3, and 4 from above are
now considered a single feature):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">num_features</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labeled_array</span>
<span class="go">array([[0, 0, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0],</span>
<span class="go">       [2, 2, 0, 0, 1, 0],</span>
<span class="go">       [0, 0, 0, 1, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_labeled_comprehension">
<code class="sig-name descname">sp_labeled_comprehension</code><span class="sig-paren">(</span><em class="sig-param">labels</em>, <em class="sig-param">index</em>, <em class="sig-param">func</em>, <em class="sig-param">out_dtype</em>, <em class="sig-param">default</em>, <em class="sig-param">pass_positions=False</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_labeled_comprehension" title="Permalink to this definition">¶</a></dt>
<dd><p>Roughly equivalent to [func(input[labels == i]) for i in index].</p>
<p>Sequentially applies an arbitrary function (that works on array_like input)
to subsets of an n-D image array specified by <cite>labels</cite> and <cite>index</cite>.
The option exists to provide the function with positional parameters as the
second argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Data from which to select <cite>labels</cite> to process.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – Labels to objects in <cite>input</cite>.
If not None, array must be same shape as <cite>input</cite>.
If None, <cite>func</cite> is applied to raveled <cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>sequence of ints</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – Subset of <cite>labels</cite> to which to apply <cite>func</cite>.
If a scalar, a single value is returned.
If None, <cite>func</cite> is applied to all non-zero values of <cite>labels</cite>.</p></li>
<li><p><strong>func</strong> (<em>callable</em>) – Python function to apply to <cite>labels</cite> from <cite>input</cite>.</p></li>
<li><p><strong>out_dtype</strong> (<em>dtype</em>) – Dtype to use for <cite>result</cite>.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – Default return value when a element of <cite>index</cite> does not exist
in <cite>labels</cite>.</p></li>
<li><p><strong>pass_positions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If True, pass linear indices to <cite>func</cite> as a second argument.
Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>result</strong> – Result of applying <cite>func</cite> to each of <cite>labels</cite> to <cite>input</cite> in <cite>index</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lbl</span><span class="p">,</span> <span class="n">nlbl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlbl</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">labeled_comprehension</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">lbls</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">array([ 2.75,  5.5 ,  6.  ])</span>
</pre></div>
</div>
<p>Falling back to <cite>default</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlbl</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">labeled_comprehension</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">lbls</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 2.75,  5.5 ,  6.  , -1.  ])</span>
</pre></div>
</div>
<p>Passing positions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">fn</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fn says: </span><span class="si">%s</span><span class="s2"> : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">pos</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span> <span class="k">if</span> <span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="o">-</span><span class="n">val</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">labeled_comprehension</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">lbls</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">fn says: [1 2 5 3] : [0 1 4 5]</span>
<span class="go">fn says: [4 7] : [ 7 11]</span>
<span class="go">fn says: [9 3] : [12 13]</span>
<span class="go">array([ 11.,  11., -12.,   0.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_laplace">
<code class="sig-name descname">sp_laplace</code><span class="sig-paren">(</span><em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>N-dimensional Laplace filter based on approximate second derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">laplace</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_map_coordinates">
<code class="sig-name descname">sp_map_coordinates</code><span class="sig-paren">(</span><em class="sig-param">coordinates</em>, <em class="sig-param">output=None</em>, <em class="sig-param">order=3</em>, <em class="sig-param">mode='constant'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">prefilter=True</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_map_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Map the input array to new coordinates by interpolation.</p>
<p>The array of coordinates is used to find, for each point in the output,
the corresponding coordinates in the input. The value of the input at
those coordinates is determined by spline interpolation of the
requested order.</p>
<p>The shape of the output is derived from that of the coordinate
array by dropping the first axis. The values of the array along
the first axis are the coordinates in the input array at which the
output value is found.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>coordinates</strong> (<em>array_like</em>) – The coordinates at which <cite>input</cite> is evaluated.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline interpolation, default is 3.
The order has to be in the range 0-5.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>prefilter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the input array is prefiltered with <cite>spline_filter</cite>
before interpolation. The default is True, which will create a
temporary <cite>float64</cite> array of filtered values if <cite>order &gt; 1</cite>. If
setting this to False, the output will be slightly blurred if
<cite>order &gt; 1</cite>, unless the input is prefiltered, i.e. it is the result
of calling <cite>spline_filter</cite> on the original input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>map_coordinates</strong> – The result of transforming the input. The shape of the output is
derived from that of <cite>coordinates</cite> by dropping the first axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">spline_filter()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">geometric_transform()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">scipy.interpolate()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">12.</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[  0.,   1.,   2.],</span>
<span class="go">       [  3.,   4.,   5.],</span>
<span class="go">       [  6.,   7.,   8.],</span>
<span class="go">       [  9.,  10.,  11.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">map_coordinates</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 2.,  7.])</span>
</pre></div>
</div>
<p>Above, the interpolated value of a[0.5, 0.5] gives output[0], while
a[2, 1] is output[1].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">map_coordinates</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cval</span><span class="o">=-</span><span class="mf">33.3</span><span class="p">)</span>
<span class="go">array([  2. , -33.3])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">map_coordinates</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span>
<span class="go">array([ 2.,  8.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">map_coordinates</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">inds</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cval</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="go">array([ True, False], dtype=bool)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_maximum">
<code class="sig-name descname">sp_maximum</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_maximum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the maximum of the values of an array over labeled regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array_like of values. For each region specified by <cite>labels</cite>, the
maximal values of <cite>input</cite> over the region is computed.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array of integers marking different regions over which the
maximum value of <cite>input</cite> is to be computed. <cite>labels</cite> must have the
same shape as <cite>input</cite>. If <cite>labels</cite> is not specified, the maximum
over the whole array is returned.</p></li>
<li><p><strong>index</strong> (<em>array_like</em><em>, </em><em>optional</em>) – A list of region labels that are taken into account for computing the
maxima. If index is None, the maximum over all elements where <cite>labels</cite>
is non-zero is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – List of maxima of <cite>input</cite> over the regions determined by <cite>labels</cite> and
whose index is in <cite>index</cite>. If <cite>index</cite> or <cite>labels</cite> are not specified, a
float is returned: the maximal value of <cite>input</cite> if <cite>labels</cite> is None,
and the maximal value of elements where <cite>labels</cite> is greater than zero
if <cite>index</cite> is None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or list of floats</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">median()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum_position()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_deviation()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The function returns a Python list and not a Numpy array, use
<cite>np.array</cite> to convert the list to an array.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[ 0,  1,  2,  3],</span>
<span class="go">       [ 4,  5,  6,  7],</span>
<span class="go">       [ 8,  9, 10, 11],</span>
<span class="go">       [12, 13, 14, 15]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">[</span><span class="mi">2</span><span class="p">:,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span>
<span class="go">array([[1, 1, 0, 0],</span>
<span class="go">       [1, 1, 0, 0],</span>
<span class="go">       [0, 2, 2, 0],</span>
<span class="go">       [0, 2, 2, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">15.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[5.0, 14.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="go">14.0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">labels_nb</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span>
<span class="go">array([[1, 1, 0, 0],</span>
<span class="go">       [1, 1, 0, 2],</span>
<span class="go">       [0, 0, 0, 2],</span>
<span class="go">       [3, 3, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels_nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">[5.0, 7.0, 9.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_maximum_filter">
<code class="sig-name descname">sp_maximum_filter</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_maximum_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multi-dimensional maximum filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<em>scalar</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – See footprint, below. Ignored if footprint is given.</p></li>
<li><p><strong>footprint</strong> (<em>array</em><em>, </em><em>optional</em>) – Either <cite>size</cite> or <cite>footprint</cite> must be defined.  <cite>size</cite> gives
the shape that is taken from the input array, at every element
position, to define the input to the filter function.
<cite>footprint</cite> is a boolean array that specifies (implicitly) a
shape, but also which of the elements within this shape will get
passed to the filter function.  Thus <code class="docutils literal notranslate"><span class="pre">size=(n,m)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">footprint=np.ones((n,m))</span></code>.  We adjust <cite>size</cite> to the number
of dimensions of the input array, so that, if the input array is
shape (10,10,10), and <cite>size</cite> is 2, then the actual size used is
(2,2,2). When <cite>footprint</cite> is given, <cite>size</cite> is ignored.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>maximum_filter</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">maximum_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_maximum_filter1d">
<code class="sig-name descname">sp_maximum_filter1d</code><span class="sig-paren">(</span><em class="sig-param">size</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_maximum_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional maximum filter along the given axis.</p>
<p>The lines of the array along the given axis are filtered with a
maximum filter of given size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Length along which to calculate the 1-D maximum.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>maximum1d</strong> – Maximum-filtered array with same shape as input.
None if <cite>output</cite> is not None</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)">None</a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function implements the MAXLIST algorithm <a href="#id69"><span class="problematic" id="id42">[1]_</span></a>, as described by
Richard Harter <a href="#id70"><span class="problematic" id="id43">[2]_</span></a>, and has a guaranteed O(n) performance, <cite>n</cite> being
the <cite>input</cite> length, regardless of filter size.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id44"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.42.2777">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.42.2777</a></p>
</dd>
<dt class="label" id="id45"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="http://www.richardhartersworld.com/cri/2001/slidingmin.html">http://www.richardhartersworld.com/cri/2001/slidingmin.html</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">maximum_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">maximum_filter1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([8, 8, 8, 4, 9, 9, 9, 9])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_maximum_position">
<code class="sig-name descname">sp_maximum_position</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_maximum_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the positions of the maximums of the values of an array at labels.</p>
<p>For each region specified by <cite>labels</cite>, the position of the maximum
value of <cite>input</cite> within the region is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array_like of values.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>An array of integers marking different regions over which the
position of the maximum value of <cite>input</cite> is to be computed.
<cite>labels</cite> must have the same shape as <cite>input</cite>. If <cite>labels</cite> is not
specified, the location of the first maximum over the whole
array is returned.</p>
<p>The <cite>labels</cite> argument only works when <cite>index</cite> is specified.</p>
</p></li>
<li><p><strong>index</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A list of region labels that are taken into account for finding the
location of the maxima.  If <cite>index</cite> is None, the first maximum
over all elements where <cite>labels</cite> is non-zero is returned.</p>
<p>The <cite>index</cite> argument only works when <cite>labels</cite> is specified.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> – List of tuples of ints that specify the location of maxima of
<cite>input</cite> over the regions determined by <cite>labels</cite> and whose index
is in <cite>index</cite>.</p>
<p>If <cite>index</cite> or <cite>labels</cite> are not specified, a tuple of ints is
returned specifying the location of the <code class="docutils literal notranslate"><span class="pre">first</span></code> maximal value
of <cite>input</cite>.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">median()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum_position()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_deviation()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_mean">
<code class="sig-name descname">sp_mean</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the mean of the values of an array at labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array on which to compute the mean of elements over distinct
regions.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Array of labels of same shape, or broadcastable to the same shape as
<cite>input</cite>. All elements sharing the same label form one region over
which the mean of the elements is computed.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – Labels of the objects over which the mean is to be computed.
Default is None, in which case the mean for all values where label is
greater than 0 is calculated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Sequence of same length as <cite>index</cite>, with the mean of the different
regions labeled by the labels in <cite>index</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)">list</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.standard_deviation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.maximum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.sum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.label()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 1, 1],</span>
<span class="go">       [0, 0, 0, 1, 1]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">index</span>
<span class="go">array([0, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
<span class="go">[10.285714285714286, 21.0]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_median">
<code class="sig-name descname">sp_median</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the median of the values of an array over labeled regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array_like of values. For each region specified by <cite>labels</cite>, the
median value of <cite>input</cite> over the region is computed.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array_like of integers marking different regions over which the
median value of <cite>input</cite> is to be computed. <cite>labels</cite> must have the
same shape as <cite>input</cite>. If <cite>labels</cite> is not specified, the median
over the whole array is returned.</p></li>
<li><p><strong>index</strong> (<em>array_like</em><em>, </em><em>optional</em>) – A list of region labels that are taken into account for computing the
medians. If index is None, the median over all elements where <cite>labels</cite>
is non-zero is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>median</strong> – List of medians of <cite>input</cite> over the regions determined by <cite>labels</cite> and
whose index is in <cite>index</cite>. If <cite>index</cite> or <cite>labels</cite> are not specified, a
float is returned: the median value of <cite>input</cite> if <cite>labels</cite> is None,
and the median value of elements where <cite>labels</cite> is greater than zero
if <cite>index</cite> is None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or list of floats</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_deviation()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The function returns a Python list and not a Numpy array, use
<cite>np.array</cite> to convert the list to an array.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">labels_nb</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span>
<span class="go">array([[1, 1, 0, 2],</span>
<span class="go">       [1, 1, 0, 2],</span>
<span class="go">       [0, 0, 0, 2],</span>
<span class="go">       [3, 3, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels_nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">[2.5, 4.0, 6.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="go">3.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_median_filter">
<code class="sig-name descname">sp_median_filter</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_median_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multidimensional median filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<em>scalar</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – See footprint, below. Ignored if footprint is given.</p></li>
<li><p><strong>footprint</strong> (<em>array</em><em>, </em><em>optional</em>) – Either <cite>size</cite> or <cite>footprint</cite> must be defined.  <cite>size</cite> gives
the shape that is taken from the input array, at every element
position, to define the input to the filter function.
<cite>footprint</cite> is a boolean array that specifies (implicitly) a
shape, but also which of the elements within this shape will get
passed to the filter function.  Thus <code class="docutils literal notranslate"><span class="pre">size=(n,m)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">footprint=np.ones((n,m))</span></code>.  We adjust <cite>size</cite> to the number
of dimensions of the input array, so that, if the input array is
shape (10,10,10), and <cite>size</cite> is 2, then the actual size used is
(2,2,2). When <cite>footprint</cite> is given, <cite>size</cite> is ignored.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>median_filter</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">median_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_minimum">
<code class="sig-name descname">sp_minimum</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_minimum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the minimum of the values of an array over labeled regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array_like of values. For each region specified by <cite>labels</cite>, the
minimal values of <cite>input</cite> over the region is computed.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – An array_like of integers marking different regions over which the
minimum value of <cite>input</cite> is to be computed. <cite>labels</cite> must have the
same shape as <cite>input</cite>. If <cite>labels</cite> is not specified, the minimum
over the whole array is returned.</p></li>
<li><p><strong>index</strong> (<em>array_like</em><em>, </em><em>optional</em>) – A list of region labels that are taken into account for computing the
minima. If index is None, the minimum over all elements where <cite>labels</cite>
is non-zero is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>minimum</strong> – List of minima of <cite>input</cite> over the regions determined by <cite>labels</cite> and
whose index is in <cite>index</cite>. If <cite>index</cite> or <cite>labels</cite> are not specified, a
float is returned: the minimal value of <cite>input</cite> if <cite>labels</cite> is None,
and the minimal value of elements where <cite>labels</cite> is greater than zero
if <cite>index</cite> is None.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or list of floats</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">median()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum_position()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_deviation()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>The function returns a Python list and not a Numpy array, use
<cite>np.array</cite> to convert the list to an array.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span><span class="p">,</span> <span class="n">labels_nb</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span>
<span class="go">array([[1, 1, 0, 0],</span>
<span class="go">       [1, 1, 0, 2],</span>
<span class="go">       [0, 0, 0, 2],</span>
<span class="go">       [3, 3, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">labels_nb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">[1.0, 4.0, 3.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_minimum_filter">
<code class="sig-name descname">sp_minimum_filter</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_minimum_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multi-dimensional minimum filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<em>scalar</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – See footprint, below. Ignored if footprint is given.</p></li>
<li><p><strong>footprint</strong> (<em>array</em><em>, </em><em>optional</em>) – Either <cite>size</cite> or <cite>footprint</cite> must be defined.  <cite>size</cite> gives
the shape that is taken from the input array, at every element
position, to define the input to the filter function.
<cite>footprint</cite> is a boolean array that specifies (implicitly) a
shape, but also which of the elements within this shape will get
passed to the filter function.  Thus <code class="docutils literal notranslate"><span class="pre">size=(n,m)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">footprint=np.ones((n,m))</span></code>.  We adjust <cite>size</cite> to the number
of dimensions of the input array, so that, if the input array is
shape (10,10,10), and <cite>size</cite> is 2, then the actual size used is
(2,2,2). When <cite>footprint</cite> is given, <cite>size</cite> is ignored.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>minimum_filter</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">minimum_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_minimum_filter1d">
<code class="sig-name descname">sp_minimum_filter1d</code><span class="sig-paren">(</span><em class="sig-param">size</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_minimum_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional minimum filter along the given axis.</p>
<p>The lines of the array along the given axis are filtered with a
minimum filter of given size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – length along which to calculate 1D minimum</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function implements the MINLIST algorithm <a href="#id71"><span class="problematic" id="id46">[1]_</span></a>, as described by
Richard Harter <a href="#id72"><span class="problematic" id="id47">[2]_</span></a>, and has a guaranteed O(n) performance, <cite>n</cite> being
the <cite>input</cite> length, regardless of filter size.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id48"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.42.2777">http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.42.2777</a></p>
</dd>
<dt class="label" id="id49"><span class="brackets">2</span></dt>
<dd><p><a class="reference external" href="http://www.richardhartersworld.com/cri/2001/slidingmin.html">http://www.richardhartersworld.com/cri/2001/slidingmin.html</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">minimum_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimum_filter1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([2, 0, 0, 0, 1, 1, 0, 0])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_minimum_position">
<code class="sig-name descname">sp_minimum_position</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_minimum_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the positions of the minimums of the values of an array at labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array_like of values.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>An array of integers marking different regions over which the
position of the minimum value of <cite>input</cite> is to be computed.
<cite>labels</cite> must have the same shape as <cite>input</cite>. If <cite>labels</cite> is not
specified, the location of the first minimum over the whole
array is returned.</p>
<p>The <cite>labels</cite> argument only works when <cite>index</cite> is specified.</p>
</p></li>
<li><p><strong>index</strong> (<em>array_like</em><em>, </em><em>optional</em>) – <p>A list of region labels that are taken into account for finding the
location of the minima. If <cite>index</cite> is None, the <code class="docutils literal notranslate"><span class="pre">first</span></code> minimum
over all elements where <cite>labels</cite> is non-zero is returned.</p>
<p>The <cite>index</cite> argument only works when <cite>labels</cite> is specified.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>output</strong> – Tuple of ints or list of tuples of ints that specify the location
of minima of <cite>input</cite> over the regions determined by <cite>labels</cite> and
whose index is in <cite>index</cite>.</p>
<p>If <cite>index</cite> or <cite>labels</cite> are not specified, a tuple of ints is
returned specifying the location of the first minimal value of <cite>input</cite>.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of tuples of ints</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">median()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum_position()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">sum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_deviation()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum_position</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">(2, 0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum_position</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">(0, 2)</span>
</pre></div>
</div>
<p>Features to process can be specified using <cite>labels</cite> and <cite>index</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum_position</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[(2, 0)]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">label</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">minimum_position</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[(0, 0), (0, 3), (3, 1)]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_morphological_gradient">
<code class="sig-name descname">sp_morphological_gradient</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_morphological_gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional morphological gradient.</p>
<p>The morphological gradient is calculated as the difference between a
dilation and an erosion of the input with a given structuring element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Array over which to compute the morphlogical gradient.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em>) – Shape of a flat and full structuring element used for the mathematical
morphology operations. Optional if <cite>footprint</cite> or <cite>structure</cite> is
provided. A larger <cite>size</cite> yields a more blurred gradient.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of non-infinite elements of a flat structuring element
used for the morphology operations. Larger footprints
give a more blurred morphological gradient.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the morphology operations.
<cite>structure</cite> may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the morphological gradient
may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>morphological_gradient</strong> – Morphological gradient of <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_dilation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">grey_erosion()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">ndimage.gaussian_gradient_magnitude()</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>For a flat structuring element, the morphological gradient
computed at a given point corresponds to the maximal difference
between elements of the input among the elements covered by the
structuring element centered on the point.</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id50"><span class="brackets">1</span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Mathematical_morphology">https://en.wikipedia.org/wiki/Mathematical_morphology</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">morphological_gradient</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 0, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The morphological gradient is computed as the difference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># between a dilation and an erosion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">grey_dilation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span> <span class="o">-</span>\
<span class="gp">... </span> <span class="n">ndimage</span><span class="o">.</span><span class="n">grey_erosion</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 0, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 1, 1, 1, 1, 1, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 1, 3, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 1, 0, 0],</span>
<span class="go">       [0, 0, 1, 1, 2, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">morphological_gradient</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="go">array([[0, 0, 0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 3, 3, 3, 1, 0],</span>
<span class="go">       [0, 1, 3, 2, 3, 2, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 1, 1, 2, 2, 2, 0],</span>
<span class="go">       [0, 0, 0, 0, 0, 0, 0]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_morphological_laplace">
<code class="sig-name descname">sp_morphological_laplace</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_morphological_laplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional morphological laplace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – See <cite>structure</cite>.</p></li>
<li><p><strong>footprint</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em> or </em><em>ndarray</em><em>, </em><em>optional</em>) – See <cite>structure</cite>.</p></li>
<li><p><strong>structure</strong> (<em>structure</em><em>, </em><em>optional</em>) – Either <cite>size</cite>, <cite>footprint</cite>, or the <cite>structure</cite> must be provided.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – An output array can optionally be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>,</em><em>'constant'</em><em>,</em><em>'nearest'</em><em>,</em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The mode parameter determines how the array borders are handled.
For ‘constant’ mode, values beyond borders are set to be <cite>cval</cite>.
Default is ‘reflect’.</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if mode is ‘constant’.
Default is 0.0</p></li>
<li><p><strong>origin</strong> (<em>origin</em><em>, </em><em>optional</em>) – The origin parameter controls the placement of the filter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>morphological_laplace</strong> – Output</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_pad">
<code class="sig-name descname">sp_pad</code><span class="sig-paren">(</span><em class="sig-param">pad_width</em>, <em class="sig-param">mode</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Pads an array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> (<em>array_like of rank N</em>) – Input array</p></li>
<li><p><strong>pad_width</strong> (<em>{sequence</em><em>, </em><em>array_like</em><em>, </em><em>int}</em>) – Number of values padded to the edges of each axis.
((before_1, after_1), … (before_N, after_N)) unique pad widths
for each axis.
((before, after),) yields same before and after pad for each axis.
(pad,) or int is a shortcut for before = after = pad width for all
axes.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>function</em>) – <p>One of the following string values or a user supplied function.</p>
<dl class="simple">
<dt>’constant’</dt><dd><p>Pads with a constant value.</p>
</dd>
<dt>’edge’</dt><dd><p>Pads with the edge values of array.</p>
</dd>
<dt>’linear_ramp’</dt><dd><p>Pads with the linear ramp between end_value and the
array edge value.</p>
</dd>
<dt>’maximum’</dt><dd><p>Pads with the maximum value of all or part of the
vector along each axis.</p>
</dd>
<dt>’mean’</dt><dd><p>Pads with the mean value of all or part of the
vector along each axis.</p>
</dd>
<dt>’median’</dt><dd><p>Pads with the median value of all or part of the
vector along each axis.</p>
</dd>
<dt>’minimum’</dt><dd><p>Pads with the minimum value of all or part of the
vector along each axis.</p>
</dd>
<dt>’reflect’</dt><dd><p>Pads with the reflection of the vector mirrored on
the first and last values of the vector along each
axis.</p>
</dd>
<dt>’symmetric’</dt><dd><p>Pads with the reflection of the vector mirrored
along the edge of the array.</p>
</dd>
<dt>’wrap’</dt><dd><p>Pads with the wrap of the vector along the axis.
The first values are used to pad the end and the
end values are used to pad the beginning.</p>
</dd>
<dt>&lt;function&gt;</dt><dd><p>Padding function, see Notes.</p>
</dd>
</dl>
</p></li>
<li><p><strong>stat_length</strong> (<em>sequence</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – <p>Used in ‘maximum’, ‘mean’, ‘median’, and ‘minimum’.  Number of
values at edge of each axis used to calculate the statistic value.</p>
<p>((before_1, after_1), … (before_N, after_N)) unique statistic
lengths for each axis.</p>
<p>((before, after),) yields same before and after statistic lengths
for each axis.</p>
<p>(stat_length,) or int is a shortcut for before = after = statistic
length for all axes.</p>
<p>Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, to use the entire axis.</p>
</p></li>
<li><p><strong>constant_values</strong> (<em>sequence</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – <p>Used in ‘constant’.  The values to set the padded values for each
axis.</p>
<p>((before_1, after_1), … (before_N, after_N)) unique pad constants
for each axis.</p>
<p>((before, after),) yields same before and after constants for each
axis.</p>
<p>(constant,) or int is a shortcut for before = after = constant for
all axes.</p>
<p>Default is 0.</p>
</p></li>
<li><p><strong>end_values</strong> (<em>sequence</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – <p>Used in ‘linear_ramp’.  The values used for the ending value of the
linear_ramp and that will form the edge of the padded array.</p>
<p>((before_1, after_1), … (before_N, after_N)) unique end values
for each axis.</p>
<p>((before, after),) yields same before and after end values for each
axis.</p>
<p>(constant,) or int is a shortcut for before = after = end value for
all axes.</p>
<p>Default is 0.</p>
</p></li>
<li><p><strong>reflect_type</strong> (<em>{'even'</em><em>, </em><em>'odd'}</em><em>, </em><em>optional</em>) – Used in ‘reflect’, and ‘symmetric’.  The ‘even’ style is the
default with an unaltered reflection around the edge value.  For
the ‘odd’ style, the extended part of the array is created by
subtracting the reflected values from two times the edge value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>pad</strong> – Padded array of rank equal to <cite>array</cite> with shape increased
according to <cite>pad_width</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.7.0.</span></p>
</div>
<p>For an array with rank greater than 1, some of the padding of later
axes is calculated from padding of previous axes.  This is easiest to
think about with a rank 2 array where the corners of the padded array
are calculated by using padded values from the first axis.</p>
<p>The padding function, if used, should return a rank 1 array equal in
length to the vector argument with padded values replaced. It has the
following signature:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">padding_func</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">iaxis_pad_width</span><span class="p">,</span> <span class="n">iaxis</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>where</p>
<blockquote>
<div><dl class="simple">
<dt>vector<span class="classifier">ndarray</span></dt><dd><p>A rank 1 array already padded with zeros.  Padded values are
vector[:pad_tuple[0]] and vector[-pad_tuple[1]:].</p>
</dd>
<dt>iaxis_pad_width<span class="classifier">tuple</span></dt><dd><p>A 2-tuple of ints, iaxis_pad_width[0] represents the number of
values padded at the beginning of vector where
iaxis_pad_width[1] represents the number of values padded at
the end of vector.</p>
</dd>
<dt>iaxis<span class="classifier">int</span></dt><dd><p>The axis currently being calculated.</p>
</dd>
<dt>kwargs<span class="classifier">dict</span></dt><dd><p>Any keyword arguments the function requires.</p>
</dd>
</dl>
</div></blockquote>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">constant_values</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="go">array([4, 4, 1, 2, 3, 4, 5, 6, 6, 6])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;edge&#39;</span><span class="p">)</span>
<span class="go">array([1, 1, 1, 2, 3, 4, 5, 5, 5, 5])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;linear_ramp&#39;</span><span class="p">,</span> <span class="n">end_values</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">))</span>
<span class="go">array([ 5,  3,  1,  2,  3,  4,  5,  2, -1, -4])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="s1">&#39;maximum&#39;</span><span class="p">)</span>
<span class="go">array([5, 5, 1, 2, 3, 4, 5, 5, 5])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="s1">&#39;mean&#39;</span><span class="p">)</span>
<span class="go">array([3, 3, 1, 2, 3, 4, 5, 3, 3])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,),</span> <span class="s1">&#39;median&#39;</span><span class="p">)</span>
<span class="go">array([3, 3, 1, 2, 3, 4, 5, 3, 3])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)),</span> <span class="s1">&#39;minimum&#39;</span><span class="p">)</span>
<span class="go">array([[1, 1, 1, 2, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 2, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 2, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 2, 1, 1, 1],</span>
<span class="go">       [3, 3, 3, 4, 3, 3, 3],</span>
<span class="go">       [1, 1, 1, 2, 1, 1, 1],</span>
<span class="go">       [1, 1, 1, 2, 1, 1, 1]])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;reflect&#39;</span><span class="p">)</span>
<span class="go">array([3, 2, 1, 2, 3, 4, 5, 4, 3, 2])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;reflect&#39;</span><span class="p">,</span> <span class="n">reflect_type</span><span class="o">=</span><span class="s1">&#39;odd&#39;</span><span class="p">)</span>
<span class="go">array([-1,  0,  1,  2,  3,  4,  5,  6,  7,  8])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">)</span>
<span class="go">array([2, 1, 1, 2, 3, 4, 5, 5, 4, 3])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;symmetric&#39;</span><span class="p">,</span> <span class="n">reflect_type</span><span class="o">=</span><span class="s1">&#39;odd&#39;</span><span class="p">)</span>
<span class="go">array([0, 1, 1, 2, 3, 4, 5, 5, 6, 7])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="s1">&#39;wrap&#39;</span><span class="p">)</span>
<span class="go">array([4, 5, 1, 2, 3, 4, 5, 1, 2, 3])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">pad_with</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="n">pad_width</span><span class="p">,</span> <span class="n">iaxis</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">pad_value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;padder&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">vector</span><span class="p">[:</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pad_value</span>
<span class="gp">... </span>    <span class="n">vector</span><span class="p">[</span><span class="o">-</span><span class="n">pad_width</span><span class="p">[</span><span class="mi">1</span><span class="p">]:]</span> <span class="o">=</span> <span class="n">pad_value</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">vector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pad_with</span><span class="p">)</span>
<span class="go">array([[10, 10, 10, 10, 10, 10, 10],</span>
<span class="go">       [10, 10, 10, 10, 10, 10, 10],</span>
<span class="go">       [10, 10,  0,  1,  2, 10, 10],</span>
<span class="go">       [10, 10,  3,  4,  5, 10, 10],</span>
<span class="go">       [10, 10, 10, 10, 10, 10, 10],</span>
<span class="go">       [10, 10, 10, 10, 10, 10, 10]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">pad_with</span><span class="p">,</span> <span class="n">padder</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">array([[100, 100, 100, 100, 100, 100, 100],</span>
<span class="go">       [100, 100, 100, 100, 100, 100, 100],</span>
<span class="go">       [100, 100,   0,   1,   2, 100, 100],</span>
<span class="go">       [100, 100,   3,   4,   5, 100, 100],</span>
<span class="go">       [100, 100, 100, 100, 100, 100, 100],</span>
<span class="go">       [100, 100, 100, 100, 100, 100, 100]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_percentile_filter">
<code class="sig-name descname">sp_percentile_filter</code><span class="sig-paren">(</span><em class="sig-param">percentile</em>, <em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_percentile_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multi-dimensional percentile filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>percentile</strong> (<em>scalar</em>) – The percentile parameter may be less then zero, i.e.,
percentile = -20 equals percentile = 80</p></li>
<li><p><strong>size</strong> (<em>scalar</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – See footprint, below. Ignored if footprint is given.</p></li>
<li><p><strong>footprint</strong> (<em>array</em><em>, </em><em>optional</em>) – Either <cite>size</cite> or <cite>footprint</cite> must be defined.  <cite>size</cite> gives
the shape that is taken from the input array, at every element
position, to define the input to the filter function.
<cite>footprint</cite> is a boolean array that specifies (implicitly) a
shape, but also which of the elements within this shape will get
passed to the filter function.  Thus <code class="docutils literal notranslate"><span class="pre">size=(n,m)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">footprint=np.ones((n,m))</span></code>.  We adjust <cite>size</cite> to the number
of dimensions of the input array, so that, if the input array is
shape (10,10,10), and <cite>size</cite> is 2, then the actual size used is
(2,2,2). When <cite>footprint</cite> is given, <cite>size</cite> is ignored.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>percentile_filter</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">percentile_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">percentile</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_prewitt">
<code class="sig-name descname">sp_prewitt</code><span class="sig-paren">(</span><em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_prewitt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a Prewitt filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">prewitt</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_rank_filter">
<code class="sig-name descname">sp_rank_filter</code><span class="sig-paren">(</span><em class="sig-param">rank</em>, <em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_rank_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a multi-dimensional rank filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – The rank parameter may be less then zero, i.e., rank = -1
indicates the largest element.</p></li>
<li><p><strong>size</strong> (<em>scalar</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em>, </em><em>optional</em>) – See footprint, below. Ignored if footprint is given.</p></li>
<li><p><strong>footprint</strong> (<em>array</em><em>, </em><em>optional</em>) – Either <cite>size</cite> or <cite>footprint</cite> must be defined.  <cite>size</cite> gives
the shape that is taken from the input array, at every element
position, to define the input to the filter function.
<cite>footprint</cite> is a boolean array that specifies (implicitly) a
shape, but also which of the elements within this shape will get
passed to the filter function.  Thus <code class="docutils literal notranslate"><span class="pre">size=(n,m)</span></code> is equivalent
to <code class="docutils literal notranslate"><span class="pre">footprint=np.ones((n,m))</span></code>.  We adjust <cite>size</cite> to the number
of dimensions of the input array, so that, if the input array is
shape (10,10,10), and <cite>size</cite> is 2, then the actual size used is
(2,2,2). When <cite>footprint</cite> is given, <cite>size</cite> is ignored.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rank_filter</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">rank_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_resize">
<code class="sig-name descname">sp_resize</code><span class="sig-paren">(</span><em class="sig-param">output_shape</em>, <em class="sig-param">order=1</em>, <em class="sig-param">mode=None</em>, <em class="sig-param">cval=0</em>, <em class="sig-param">clip=True</em>, <em class="sig-param">preserve_range=False</em>, <em class="sig-param">anti_aliasing=None</em>, <em class="sig-param">anti_aliasing_sigma=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize image to match a certain size.</p>
<p>Performs interpolation to up-size or down-size images. Note that anti-
aliasing should be enabled when down-sizing images to avoid aliasing
artifacts. For down-sampling N-dimensional images with an integer factor
also see <cite>skimage.transform.downscale_local_mean</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>ndarray</em>) – Input image.</p></li>
<li><p><strong>output_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)"><em>tuple</em></a><em> or </em><em>ndarray</em>) – Size of the generated output image <cite>(rows, cols[, …][, dim])</cite>. If
<cite>dim</cite> is not provided, the number of channels is preserved. In case the
number of input channels does not equal the number of output channels a
n-dimensional interpolation is applied.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>resized</strong> – Resized version of the input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Other Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>order</strong> (<em>int, optional</em>) – The order of the spline interpolation, default is 1. The order has to
be in the range 0-5. See <cite>skimage.transform.warp</cite> for detail.</p></li>
<li><p><strong>mode</strong> (<em>{‘constant’, ‘edge’, ‘symmetric’, ‘reflect’, ‘wrap’}, optional</em>) – Points outside the boundaries of the input are filled according
to the given mode.  Modes match the behaviour of <cite>numpy.pad</cite>.  The
default mode is ‘constant’.</p></li>
<li><p><strong>cval</strong> (<em>float, optional</em>) – Used in conjunction with mode ‘constant’, the value outside
the image boundaries.</p></li>
<li><p><strong>clip</strong> (<em>bool, optional</em>) – Whether to clip the output to the range of values of the input image.
This is enabled by default, since higher order interpolation may
produce values outside the given input range.</p></li>
<li><p><strong>preserve_range</strong> (<em>bool, optional</em>) – Whether to keep the original range of values. Otherwise, the input
image is converted according to the conventions of <cite>img_as_float</cite>.</p></li>
<li><p><strong>anti_aliasing</strong> (<em>bool, optional</em>) – Whether to apply a Gaussian filter to smooth the image prior to
down-scaling. It is crucial to filter when down-sampling the image to
avoid aliasing artifacts.</p></li>
<li><p><strong>anti_aliasing_sigma</strong> (<em>{float, tuple of floats}, optional</em>) – Standard deviation for Gaussian filtering to avoid aliasing artifacts.
By default, this value is chosen as (1 - s) / 2 where s is the
down-scaling factor.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Modes ‘reflect’ and ‘symmetric’ are similar, but differ in whether the edge
pixels are duplicated during the reflection.  As an example, if an array
has values [0, 1, 2] and was padded to the right by four values using
symmetric, the result would be [0, 1, 2, 2, 1, 0, 0], while for reflect it
would be [0, 1, 2, 1, 0, 1, 2].</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="k">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="k">import</span> <span class="n">resize</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resize</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;reflect&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(100, 100)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_rotate">
<code class="sig-name descname">sp_rotate</code><span class="sig-paren">(</span><em class="sig-param">angle</em>, <em class="sig-param">axes=(1</em>, <em class="sig-param">0)</em>, <em class="sig-param">reshape=True</em>, <em class="sig-param">output=None</em>, <em class="sig-param">order=3</em>, <em class="sig-param">mode='constant'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">prefilter=True</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate an array.</p>
<p>The array is rotated in the plane defined by the two axes given by the
<cite>axes</cite> parameter using spline interpolation of the requested order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The rotation angle in degrees.</p></li>
<li><p><strong>axes</strong> (<em>tuple of 2 ints</em><em>, </em><em>optional</em>) – The two axes that define the plane of rotation. Default is the first
two axes.</p></li>
<li><p><strong>reshape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – If <cite>reshape</cite> is true, the output shape is adapted so that the input
array is contained completely in the output. Default is True.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline interpolation, default is 3.
The order has to be in the range 0-5.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>prefilter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the input array is prefiltered with <cite>spline_filter</cite>
before interpolation. The default is True, which will create a
temporary <cite>float64</cite> array of filtered values if <cite>order &gt; 1</cite>. If
setting this to False, the output will be slightly blurred if
<cite>order &gt; 1</cite>, unless the input is prefiltered, i.e. it is the result
of calling <cite>spline_filter</cite> on the original input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rotate</strong> – The rotated input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_shift">
<code class="sig-name descname">sp_shift</code><span class="sig-paren">(</span><em class="sig-param">shift</em>, <em class="sig-param">output=None</em>, <em class="sig-param">order=3</em>, <em class="sig-param">mode='constant'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">prefilter=True</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Shift an array.</p>
<p>The array is shifted using spline interpolation of the requested order.
Points outside the boundaries of the input are filled according to the
given mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>shift</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em>) – The shift along the axes. If a float, <cite>shift</cite> is the same for each
axis. If a sequence, <cite>shift</cite> should contain one value for each axis.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline interpolation, default is 3.
The order has to be in the range 0-5.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>prefilter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the input array is prefiltered with <cite>spline_filter</cite>
before interpolation. The default is True, which will create a
temporary <cite>float64</cite> array of filtered values if <cite>order &gt; 1</cite>. If
setting this to False, the output will be slightly blurred if
<cite>order &gt; 1</cite>, unless the input is prefiltered, i.e. it is the result
of calling <cite>spline_filter</cite> on the original input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>shift</strong> – The shifted input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_sobel">
<code class="sig-name descname">sp_sobel</code><span class="sig-paren">(</span><em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_sobel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a Sobel filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">sobel</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_spline_filter1d">
<code class="sig-name descname">sp_spline_filter1d</code><span class="sig-paren">(</span><em class="sig-param">order=3</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=&lt;class 'numpy.float64'&gt;</em>, <em class="sig-param">mode='mirror'</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_spline_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional spline filter along the given axis.</p>
<p>The lines of the array along the given axis are filtered by a
spline filter. The order of the spline must be &gt;= 2 and &lt;= 5.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline, default is 3.</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis along which the spline filter is applied. Default is the last
axis.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the returned
array. Default is <cite>numpy.float64</cite>.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>spline_filter1d</strong> – The filtered input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>All functions in <cite>ndimage.interpolation</cite> do spline interpolation of
the input image. If using b-splines of <cite>order &gt; 1</cite>, the input image
values have to be converted to b-spline coefficients first, which is
done by applying this one-dimensional filter sequentially along all
axes of the input. All functions that require b-spline coefficients
will automatically filter their inputs, a behavior controllable with
the <cite>prefilter</cite> keyword argument. For functions that accept a <cite>mode</cite>
parameter, the result will only be correct if it matches the <cite>mode</cite>
used when filtering.</p>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_standard_deviation">
<code class="sig-name descname">sp_standard_deviation</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_standard_deviation" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the standard deviation of the values of an n-D image array,
optionally at specified sub-regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Nd-image data to process.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Labels to identify sub-regions in <cite>input</cite>.
If not None, must be same shape as <cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – <cite>labels</cite> to include in output.  If None (default), all values where
<cite>labels</cite> is non-zero are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>standard_deviation</strong> – Values of standard deviation, for each sub-region if <cite>labels</cite> and
<cite>index</cite> are specified.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">variance()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">2.7585095613392387</span>
</pre></div>
</div>
<p>Features to process can be specified using <cite>labels</cite> and <cite>index</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbl</span><span class="p">,</span> <span class="n">nlbl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlbl</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">array([ 1.479,  1.5  ,  3.   ])</span>
</pre></div>
</div>
<p>If no index is given, non-zero <cite>labels</cite> are processed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">standard_deviation</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>
<span class="go">2.4874685927665499</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_sum">
<code class="sig-name descname">sp_sum</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the sum of the values of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Values of <cite>input</cite> inside the regions defined by <cite>labels</cite>
are summed together.</p></li>
<li><p><strong>labels</strong> (<em>array_like of ints</em><em>, </em><em>optional</em>) – Assign labels to the values of the array. Has to have the same shape as
<cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<em>array_like</em><em>, </em><em>optional</em>) – A single label number or a sequence of label numbers of
the objects to be measured.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sum</strong> – An array of the sums of values of <cite>input</cite> inside the regions defined
by <cite>labels</cite> with the same shape as <cite>index</cite>. If ‘index’ is None or scalar,
a scalar is returned.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray or scalar</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">mean()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">median()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">[1.0, 5.0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_uniform_filter">
<code class="sig-name descname">sp_uniform_filter</code><span class="sig-paren">(</span><em class="sig-param">size=3</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_uniform_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional uniform filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – The sizes of the uniform filter are given for each axis as a
sequence, or as a single number, in which case the size is
equal for all axes.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
when the filter overlaps a border. By passing a sequence of modes
with length equal to the number of dimensions of the input array,
different modes can be specified along each axis. Default value is
‘reflect’. The valid values and their behavior is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence</em><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right. By passing a sequence of origins with length equal to
the number of dimensions of the input array, different shifts can
be specified along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>uniform_filter</strong> – Filtered array. Has the same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The multi-dimensional filter is implemented as a sequence of
one-dimensional uniform filters. The intermediate arrays are stored
in the same data type as the output. Therefore, for output types
with a limited precision, the results may be imprecise because
intermediate results may be stored with insufficient precision.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">gray</span><span class="p">()</span>  <span class="c1"># show the filtered result in grayscale</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">uniform_filter</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_uniform_filter1d">
<code class="sig-name descname">sp_uniform_filter1d</code><span class="sig-paren">(</span><em class="sig-param">size</em>, <em class="sig-param">axis=-1</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_uniform_filter1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate a one-dimensional uniform filter along the given axis.</p>
<p>The lines of the array along the given axis are filtered with a
uniform filter of given size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – length of uniform filter</p></li>
<li><p><strong>axis</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The axis of <cite>input</cite> along which to calculate. Default is -1.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘reflect’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>origin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Controls the placement of the filter on the input array’s pixels.
A value of 0 (the default) centers the filter over the pixel, with
positive values shifting the filter to the left, and negative ones
to the right.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="k">import</span> <span class="n">uniform_filter1d</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniform_filter1d</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([4, 3, 4, 1, 4, 6, 6, 3])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_variance">
<code class="sig-name descname">sp_variance</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_variance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the variance of the values of an n-D image array, optionally at
specified sub-regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Nd-image data to process.</p></li>
<li><p><strong>labels</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Labels defining sub-regions in <cite>input</cite>.
If not None, must be same shape as <cite>input</cite>.</p></li>
<li><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>sequence of ints</em><em>, </em><em>optional</em>) – <cite>labels</cite> to include in output.  If None (default), all values where
<cite>labels</cite> is non-zero are used.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>variance</strong> – Values of variance, for each sub-region if <cite>labels</cite> and <cite>index</cite> are
specified.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">label()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">standard_deviation()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">maximum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">minimum()</span></code>, <code class="xref py py-meth docutils literal notranslate"><span class="pre">extrema()</span></code></p>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
<span class="gp">... </span>              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">7.609375</span>
</pre></div>
</div>
<p>Features to process can be specified using <cite>labels</cite> and <cite>index</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbl</span><span class="p">,</span> <span class="n">nlbl</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nlbl</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<span class="go">array([ 2.1875,  2.25  ,  9.    ])</span>
</pre></div>
</div>
<p>If no index is given, all non-zero <cite>labels</cite> are processed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ndimage</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">lbl</span><span class="p">)</span>
<span class="go">6.1875</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_watershed_ift">
<code class="sig-name descname">sp_watershed_ift</code><span class="sig-paren">(</span><em class="sig-param">markers</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_watershed_ift" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply watershed from markers using image foresting transform algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input.</p></li>
<li><p><strong>markers</strong> (<em>array_like</em>) – Markers are points within each watershed that form the beginning
of the process.  Negative markers are considered background markers
which are processed after the other markers.</p></li>
<li><p><strong>structure</strong> (<em>structure element</em><em>, </em><em>optional</em>) – A structuring element defining the connectivity of the object can be
provided. If None, an element is generated with a squared
connectivity equal to one.</p></li>
<li><p><strong>output</strong> (<em>ndarray</em><em>, </em><em>optional</em>) – An output array can optionally be provided.  The same shape as input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>watershed_ift</strong> – Output.  Same shape as <cite>input</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id51"><span class="brackets">1</span></dt>
<dd><p>A.X. Falcao, J. Stolfi and R. de Alencar Lotufo, “The image
foresting transform: theory, algorithms, and applications”,
Pattern Analysis and Machine Intelligence, vol. 26, pp. 19-29, 2004.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_white_tophat">
<code class="sig-name descname">sp_white_tophat</code><span class="sig-paren">(</span><em class="sig-param">size=None</em>, <em class="sig-param">footprint=None</em>, <em class="sig-param">structure=None</em>, <em class="sig-param">output=None</em>, <em class="sig-param">mode='reflect'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">origin=0</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_white_tophat" title="Permalink to this definition">¶</a></dt>
<dd><p>Multi-dimensional white tophat filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – Input.</p></li>
<li><p><strong>size</strong> (<em>tuple of ints</em>) – Shape of a flat and full structuring element used for the filter.
Optional if <cite>footprint</cite> or <cite>structure</cite> is provided.</p></li>
<li><p><strong>footprint</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Positions of elements of a flat structuring element
used for the white tophat filter.</p></li>
<li><p><strong>structure</strong> (<em>array of ints</em><em>, </em><em>optional</em>) – Structuring element used for the filter. <cite>structure</cite>
may be a non-flat structuring element.</p></li>
<li><p><strong>output</strong> (<em>array</em><em>, </em><em>optional</em>) – An array used for storing the output of the filter may be provided.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – The <cite>mode</cite> parameter determines how the array borders are
handled, where <cite>cval</cite> is the value when mode is equal to
‘constant’. Default is ‘reflect’</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’.
Default is 0.0.</p></li>
<li><p><strong>origin</strong> (<em>scalar</em><em>, </em><em>optional</em>) – The <cite>origin</cite> parameter controls the placement of the filter.
Default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>output</strong> – Result of the filter of <cite>input</cite> with <cite>structure</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-meth docutils literal notranslate"><span class="pre">black_tophat()</span></code></p>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.sp_zoom">
<code class="sig-name descname">sp_zoom</code><span class="sig-paren">(</span><em class="sig-param">zoom</em>, <em class="sig-param">output=None</em>, <em class="sig-param">order=3</em>, <em class="sig-param">mode='constant'</em>, <em class="sig-param">cval=0.0</em>, <em class="sig-param">prefilter=True</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.sp_zoom" title="Permalink to this definition">¶</a></dt>
<dd><p>Zoom an array.</p>
<p>The array is zoomed using spline interpolation of the requested order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input</strong> (<em>array_like</em>) – The input array.</p></li>
<li><p><strong>zoom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>sequence</em>) – The zoom factor along the axes. If a float, <cite>zoom</cite> is the same for each
axis. If a sequence, <cite>zoom</cite> should contain one value for each axis.</p></li>
<li><p><strong>output</strong> (<em>array</em><em> or </em><em>dtype</em><em>, </em><em>optional</em>) – The array in which to place the output, or the dtype of the
returned array. By default an array of the same dtype as input
will be created.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – The order of the spline interpolation, default is 3.
The order has to be in the range 0-5.</p></li>
<li><p><strong>mode</strong> (<em>{'reflect'</em><em>, </em><em>'constant'</em><em>, </em><em>'nearest'</em><em>, </em><em>'mirror'</em><em>, </em><em>'wrap'}</em><em>, </em><em>optional</em>) – <p>The <cite>mode</cite> parameter determines how the input array is extended
beyond its boundaries. Default is ‘constant’. Behavior for each valid
value is as follows:</p>
<dl class="simple">
<dt>’reflect’ (<cite>d c b a | a b c d | d c b a</cite>)</dt><dd><p>The input is extended by reflecting about the edge of the last
pixel.</p>
</dd>
<dt>’constant’ (<cite>k k k k | a b c d | k k k k</cite>)</dt><dd><p>The input is extended by filling all values beyond the edge with
the same constant value, defined by the <cite>cval</cite> parameter.</p>
</dd>
<dt>’nearest’ (<cite>a a a a | a b c d | d d d d</cite>)</dt><dd><p>The input is extended by replicating the last pixel.</p>
</dd>
<dt>’mirror’ (<cite>d c b | a b c d | c b a</cite>)</dt><dd><p>The input is extended by reflecting about the center of the last
pixel.</p>
</dd>
<dt>’wrap’ (<cite>a b c d | a b c d | a b c d</cite>)</dt><dd><p>The input is extended by wrapping around to the opposite edge.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cval</strong> (<em>scalar</em><em>, </em><em>optional</em>) – Value to fill past edges of input if <cite>mode</cite> is ‘constant’. Default
is 0.0.</p></li>
<li><p><strong>prefilter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Determines if the input array is prefiltered with <cite>spline_filter</cite>
before interpolation. The default is True, which will create a
temporary <cite>float64</cite> array of filtered values if <cite>order &gt; 1</cite>. If
setting this to False, the output will be slightly blurred if
<cite>order &gt; 1</cite>, unless the input is prefiltered, i.e. it is the result
of calling <cite>spline_filter</cite> on the original input.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>zoom</strong> – The zoomed input.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">ndimage</span><span class="p">,</span> <span class="n">misc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>  <span class="c1"># left side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>  <span class="c1"># right side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ascent</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">ascent</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">ndimage</span><span class="o">.</span><span class="n">zoom</span><span class="p">(</span><span class="n">ascent</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ascent</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ascent</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(512, 512)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1536, 1536)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.split_to_patches">
<code class="sig-name descname">split_to_patches</code><span class="sig-paren">(</span><em class="sig-param">ix</em>, <em class="sig-param">patch_shape</em>, <em class="sig-param">stride=1</em>, <em class="sig-param">drop_last=False</em>, <em class="sig-param">src='images'</em>, <em class="sig-param">dst=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/batchflow/batch_image.html#ImagesBatch.split_to_patches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#batchflow.ImagesBatch.split_to_patches" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits image to patches.</p>
<p>Small images with the same shape (<code class="docutils literal notranslate"><span class="pre">patch_shape</span></code>) are cropped from the original one with stride <code class="docutils literal notranslate"><span class="pre">stride</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>patch_shape</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>sequence</em>) – Patch’s shape in the from (rows, columns). If int is given then patches have square shape.</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>square</em>) – Step of the moving window from which patches are cropped. If int is given then the window has square shape.</p></li>
<li><p><strong>drop_last</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Whether to drop patches whose window covers area out of the image.
If False is passed then these patches are cropped from the edge of an image. See more in tutorials.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.to_array">
<code class="sig-name descname">to_array</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">dtype=None</em>, <em class="sig-param">channels='last'</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>converts images in Batch to np.ndarray format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.to_pil">
<code class="sig-name descname">to_pil</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">mode=None</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.to_pil" title="Permalink to this definition">¶</a></dt>
<dd><p>converts images in Batch to PIL format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="batchflow.ImagesBatch.transform">
<code class="sig-name descname">transform</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#batchflow.ImagesBatch.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls image.transform(<a href="#id52"><span class="problematic" id="id53">*</span></a>args, <a href="#id54"><span class="problematic" id="id55">**</span></a>kwargs)</p>
<p>For more information see <a class="reference external" href="http://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.transform">http://pillow.readthedocs.io/en/stable/reference/Image.html#PIL.Image.Image.transform</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to get images from. Default is ‘images’.</p></li>
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Component to write images to. Default is ‘images’.</p></li>
<li><p><strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Probability of applying the transform. Default is 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="batchflow.pipeline.html" title="Pipeline"
             >next</a> |</li>
        <li class="right" >
          <a href="batchflow.batch.html" title="Batch"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">BatchFlow 0.3.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="batchflow.html" >API</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="batchflow.core.html" >batchflow</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Analysis Center.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>